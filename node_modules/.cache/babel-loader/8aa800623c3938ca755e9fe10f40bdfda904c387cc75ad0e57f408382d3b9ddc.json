{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Maria\\\\Desktop\\\\Coding\\\\01dolina\\\\dolina_frontend\\\\src\\\\components\\\\AdminPanel\\\\FileUploader.js\",\n  _s = $RefreshSig$();\nimport loading from '../../images/loading.svg';\nimport './FileUploader.css';\nimport React, { useState, useCallback, useEffect } from 'react';\nimport { useDropzone } from 'react-dropzone';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction FileUploader() {\n  _s();\n  const [files, setFiles] = useState([]);\n  const [suggestedColors, setSuggestedColors] = useState([]);\n  const [imagesLoading, setImagesLoading] = useState(false);\n  const onDrop = useCallback(async acceptedFiles => {\n    const formData = new FormData();\n    acceptedFiles.forEach(file => {\n      formData.append('image', file);\n    });\n    try {\n      setImagesLoading(true);\n      const uploadedFiles = [];\n      for (const file of acceptedFiles) {\n        const formData = new FormData();\n        formData.append('image', file);\n        const response = await fetch('http://backend.dolina.shop:5000/admin/upload', {\n          method: 'POST',\n          body: formData\n        });\n        if (!response.ok) {\n          throw new Error('Failed to upload file');\n        }\n        const data = await response.json();\n        uploadedFiles.push({\n          preview: data.file,\n          name: data.file,\n          colors: data.colors\n        });\n      }\n      setImagesLoading(false);\n      setFiles(prevFiles => [...prevFiles, ...uploadedFiles]);\n    } catch (error) {\n      console.error('Error uploading files:', error);\n    }\n  }, []);\n\n  // меняем цвета когда меняются файлы, берём у первого\n  useEffect(() => {\n    if (files[0]) setSuggestedColors(files[0].colors);\n    console.log(files);\n  }, [files]);\n  const removeFile = name => {\n    setFiles(prevFiles => prevFiles.filter(file => file.name !== name));\n  };\n  const {\n    getRootProps,\n    getInputProps\n  } = useDropzone({\n    onDrop,\n    multiple: true\n  });\n  const handleDragStart = (e, index) => {\n    e.dataTransfer.setData('index', index);\n  };\n  const handleDragOver = e => {\n    e.preventDefault();\n  };\n  const handleDrop = (e, newIndex) => {\n    e.preventDefault();\n    const oldIndex = e.dataTransfer.getData('index');\n    const newFiles = [...files];\n    const movedItem = newFiles.splice(oldIndex, 1)[0];\n    newFiles.splice(newIndex, 0, movedItem);\n    setFiles(newFiles);\n  };\n  const thumbs = files.map((file, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"thumbnail-item\",\n    draggable: true,\n    onDragStart: e => handleDragStart(e, index),\n    onDragOver: handleDragOver,\n    onDrop: e => handleDrop(e, index),\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      children: /*#__PURE__*/_jsxDEV(\"img\", {\n        src: \"https://dolina.shop/photos/temp/\" + file.preview,\n        alt: file.name,\n        style: {\n          width: '90px',\n          margin: '0 8px'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      className: \"thumbnail-button\",\n      onClick: () => removeFile(file.name)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 7\n    }, this)]\n  }, file.preview, true, {\n    fileName: _jsxFileName,\n    lineNumber: 84,\n    columnNumber: 5\n  }, this));\n  const colors = suggestedColors.map((color, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      backgroundColor: color\n    },\n    \"data-id\": color\n  }, index, false, {\n    fileName: _jsxFileName,\n    lineNumber: 101,\n    columnNumber: 7\n  }, this));\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      ...getRootProps({\n        className: 'dropzone'\n      }),\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        ...getInputProps()\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"\\u0421\\u044E\\u0434\\u0430 \\u043C\\u043E\\u0436\\u043D\\u043E \\u043F\\u0435\\u0440\\u0435\\u0442\\u0430\\u0449\\u0438\\u0442\\u044C \\u0444\\u043E\\u0442\\u043E \\u0438 \\u0432\\u0438\\u0434\\u0435\\u043E\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"aside\", {\n      className: \"thumbnail-div\",\n      style: {\n        marginTop: '20px'\n      },\n      children: [imagesLoading && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"loading\",\n        children: [/*#__PURE__*/_jsxDEV(\"img\", {\n          src: loading\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 13\n        }, this), \" \\u0433\\u0440\\u0443\\u0437\\u0438\\u043C, \\u0433\\u0440\\u0443\\u0437\\u0438\\u043C\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 11\n      }, this), thumbs]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"suggestedColors\",\n      children: colors\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 5\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 105,\n    columnNumber: 5\n  }, this);\n}\n_s(FileUploader, \"PYPXp7KS2E+G9xq+PFqXOvxlN2U=\", false, function () {\n  return [useDropzone];\n});\n_c = FileUploader;\n;\nexport default FileUploader;\nvar _c;\n$RefreshReg$(_c, \"FileUploader\");","map":{"version":3,"names":["loading","React","useState","useCallback","useEffect","useDropzone","jsxDEV","_jsxDEV","FileUploader","_s","files","setFiles","suggestedColors","setSuggestedColors","imagesLoading","setImagesLoading","onDrop","acceptedFiles","formData","FormData","forEach","file","append","uploadedFiles","response","fetch","method","body","ok","Error","data","json","push","preview","name","colors","prevFiles","error","console","log","removeFile","filter","getRootProps","getInputProps","multiple","handleDragStart","e","index","dataTransfer","setData","handleDragOver","preventDefault","handleDrop","newIndex","oldIndex","getData","newFiles","movedItem","splice","thumbs","map","className","draggable","onDragStart","onDragOver","children","src","alt","style","width","margin","fileName","_jsxFileName","lineNumber","columnNumber","onClick","color","backgroundColor","marginTop","_c","$RefreshReg$"],"sources":["C:/Users/Maria/Desktop/Coding/01dolina/dolina_frontend/src/components/AdminPanel/FileUploader.js"],"sourcesContent":["\r\nimport loading from '../../images/loading.svg';\r\nimport './FileUploader.css';\r\n\r\nimport React, { useState, useCallback, useEffect } from 'react';\r\nimport { useDropzone } from 'react-dropzone';\r\n\r\nfunction FileUploader() {\r\n\r\n  const [files, setFiles] = useState([]);\r\n  const [suggestedColors, setSuggestedColors] = useState([]);\r\n  const [imagesLoading, setImagesLoading] = useState(false);\r\n\r\n  const onDrop = useCallback(async acceptedFiles => {\r\n    const formData = new FormData();\r\n    acceptedFiles.forEach(file => {\r\n      formData.append('image', file);\r\n    });\r\n\r\n    try {\r\n      setImagesLoading(true);\r\n      const uploadedFiles = [];\r\n      \r\n      for (const file of acceptedFiles) {\r\n        const formData = new FormData();\r\n        formData.append('image', file);\r\n  \r\n        const response = await fetch('http://backend.dolina.shop:5000/admin/upload', {\r\n          method: 'POST',\r\n          body: formData\r\n        });\r\n  \r\n        if (!response.ok) {\r\n          throw new Error('Failed to upload file');\r\n        }\r\n  \r\n        const data = await response.json(); \r\n        uploadedFiles.push({ preview: data.file, name: data.file, colors: data.colors });\r\n      }\r\n  \r\n      setImagesLoading(false);\r\n      setFiles(prevFiles => [...prevFiles, ...uploadedFiles]);\r\n    } catch (error) {\r\n      console.error('Error uploading files:', error);\r\n    }\r\n\r\n    \r\n  }, []);\r\n\r\n  // меняем цвета когда меняются файлы, берём у первого\r\n  useEffect(() => {\r\n    if (files[0]) setSuggestedColors(files[0].colors);\r\n    console.log(files)\r\n  }, [files]);\r\n\r\n\r\n  const removeFile = (name) => {\r\n    setFiles(prevFiles => prevFiles.filter(file => file.name !== name));\r\n  };\r\n\r\n  const { getRootProps, getInputProps } = useDropzone({ onDrop, multiple: true });\r\n\r\n\r\n\r\n  const handleDragStart = (e, index) => {\r\n    e.dataTransfer.setData('index', index);\r\n  };\r\n\r\n  const handleDragOver = (e) => {\r\n    e.preventDefault();\r\n  };\r\n\r\n  const handleDrop = (e, newIndex) => {\r\n    e.preventDefault();\r\n    const oldIndex = e.dataTransfer.getData('index');\r\n    const newFiles = [...files];\r\n    const movedItem = newFiles.splice(oldIndex, 1)[0];\r\n    newFiles.splice(newIndex, 0, movedItem);\r\n    setFiles(newFiles);\r\n  };\r\n\r\n\r\n  const thumbs = files.map((file, index) => (\r\n    <div\r\n      className='thumbnail-item'\r\n      key={file.preview}\r\n      draggable\r\n      onDragStart={(e) => handleDragStart(e, index)}\r\n      onDragOver={handleDragOver}\r\n      onDrop={(e) => handleDrop(e, index)}\r\n    >\r\n      <div>\r\n        <img src={\"https://dolina.shop/photos/temp/\" + file.preview} alt={file.name} style={{ width: '90px', margin: '0 8px'}} />\r\n      </div>\r\n      \r\n      <button className='thumbnail-button' onClick={() => removeFile(file.name)}></button>\r\n    </div>\r\n  ));\r\n\r\n  const colors = suggestedColors.map((color, index) => (\r\n      <div style={{backgroundColor: color}} data-id={color} key={index}></div>\r\n  ));\r\n\r\n  return (\r\n    <div>\r\n      <div {...getRootProps({ className: 'dropzone' })}>\r\n        <input {...getInputProps()} />\r\n        <p>Сюда можно перетащить фото и видео</p>\r\n      </div>\r\n        <aside className='thumbnail-div' style={{ marginTop: '20px' }}>\r\n        {imagesLoading && (\r\n          <div className='loading'>\r\n            <img src={loading} /> грузим, грузим\r\n          </div>\r\n        )}\r\n        {thumbs}\r\n      </aside>\r\n      \r\n    <div className='suggestedColors'>\r\n      {colors}\r\n    </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default FileUploader;\r\n"],"mappings":";;AACA,OAAOA,OAAO,MAAM,0BAA0B;AAC9C,OAAO,oBAAoB;AAE3B,OAAOC,KAAK,IAAIC,QAAQ,EAAEC,WAAW,EAAEC,SAAS,QAAQ,OAAO;AAC/D,SAASC,WAAW,QAAQ,gBAAgB;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAE7C,SAASC,YAAYA,CAAA,EAAG;EAAAC,EAAA;EAEtB,MAAM,CAACC,KAAK,EAAEC,QAAQ,CAAC,GAAGT,QAAQ,CAAC,EAAE,CAAC;EACtC,MAAM,CAACU,eAAe,EAAEC,kBAAkB,CAAC,GAAGX,QAAQ,CAAC,EAAE,CAAC;EAC1D,MAAM,CAACY,aAAa,EAAEC,gBAAgB,CAAC,GAAGb,QAAQ,CAAC,KAAK,CAAC;EAEzD,MAAMc,MAAM,GAAGb,WAAW,CAAC,MAAMc,aAAa,IAAI;IAChD,MAAMC,QAAQ,GAAG,IAAIC,QAAQ,CAAC,CAAC;IAC/BF,aAAa,CAACG,OAAO,CAACC,IAAI,IAAI;MAC5BH,QAAQ,CAACI,MAAM,CAAC,OAAO,EAAED,IAAI,CAAC;IAChC,CAAC,CAAC;IAEF,IAAI;MACFN,gBAAgB,CAAC,IAAI,CAAC;MACtB,MAAMQ,aAAa,GAAG,EAAE;MAExB,KAAK,MAAMF,IAAI,IAAIJ,aAAa,EAAE;QAChC,MAAMC,QAAQ,GAAG,IAAIC,QAAQ,CAAC,CAAC;QAC/BD,QAAQ,CAACI,MAAM,CAAC,OAAO,EAAED,IAAI,CAAC;QAE9B,MAAMG,QAAQ,GAAG,MAAMC,KAAK,CAAC,8CAA8C,EAAE;UAC3EC,MAAM,EAAE,MAAM;UACdC,IAAI,EAAET;QACR,CAAC,CAAC;QAEF,IAAI,CAACM,QAAQ,CAACI,EAAE,EAAE;UAChB,MAAM,IAAIC,KAAK,CAAC,uBAAuB,CAAC;QAC1C;QAEA,MAAMC,IAAI,GAAG,MAAMN,QAAQ,CAACO,IAAI,CAAC,CAAC;QAClCR,aAAa,CAACS,IAAI,CAAC;UAAEC,OAAO,EAAEH,IAAI,CAACT,IAAI;UAAEa,IAAI,EAAEJ,IAAI,CAACT,IAAI;UAAEc,MAAM,EAAEL,IAAI,CAACK;QAAO,CAAC,CAAC;MAClF;MAEApB,gBAAgB,CAAC,KAAK,CAAC;MACvBJ,QAAQ,CAACyB,SAAS,IAAI,CAAC,GAAGA,SAAS,EAAE,GAAGb,aAAa,CAAC,CAAC;IACzD,CAAC,CAAC,OAAOc,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,wBAAwB,EAAEA,KAAK,CAAC;IAChD;EAGF,CAAC,EAAE,EAAE,CAAC;;EAEN;EACAjC,SAAS,CAAC,MAAM;IACd,IAAIM,KAAK,CAAC,CAAC,CAAC,EAAEG,kBAAkB,CAACH,KAAK,CAAC,CAAC,CAAC,CAACyB,MAAM,CAAC;IACjDG,OAAO,CAACC,GAAG,CAAC7B,KAAK,CAAC;EACpB,CAAC,EAAE,CAACA,KAAK,CAAC,CAAC;EAGX,MAAM8B,UAAU,GAAIN,IAAI,IAAK;IAC3BvB,QAAQ,CAACyB,SAAS,IAAIA,SAAS,CAACK,MAAM,CAACpB,IAAI,IAAIA,IAAI,CAACa,IAAI,KAAKA,IAAI,CAAC,CAAC;EACrE,CAAC;EAED,MAAM;IAAEQ,YAAY;IAAEC;EAAc,CAAC,GAAGtC,WAAW,CAAC;IAAEW,MAAM;IAAE4B,QAAQ,EAAE;EAAK,CAAC,CAAC;EAI/E,MAAMC,eAAe,GAAGA,CAACC,CAAC,EAAEC,KAAK,KAAK;IACpCD,CAAC,CAACE,YAAY,CAACC,OAAO,CAAC,OAAO,EAAEF,KAAK,CAAC;EACxC,CAAC;EAED,MAAMG,cAAc,GAAIJ,CAAC,IAAK;IAC5BA,CAAC,CAACK,cAAc,CAAC,CAAC;EACpB,CAAC;EAED,MAAMC,UAAU,GAAGA,CAACN,CAAC,EAAEO,QAAQ,KAAK;IAClCP,CAAC,CAACK,cAAc,CAAC,CAAC;IAClB,MAAMG,QAAQ,GAAGR,CAAC,CAACE,YAAY,CAACO,OAAO,CAAC,OAAO,CAAC;IAChD,MAAMC,QAAQ,GAAG,CAAC,GAAG9C,KAAK,CAAC;IAC3B,MAAM+C,SAAS,GAAGD,QAAQ,CAACE,MAAM,CAACJ,QAAQ,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;IACjDE,QAAQ,CAACE,MAAM,CAACL,QAAQ,EAAE,CAAC,EAAEI,SAAS,CAAC;IACvC9C,QAAQ,CAAC6C,QAAQ,CAAC;EACpB,CAAC;EAGD,MAAMG,MAAM,GAAGjD,KAAK,CAACkD,GAAG,CAAC,CAACvC,IAAI,EAAE0B,KAAK,kBACnCxC,OAAA;IACEsD,SAAS,EAAC,gBAAgB;IAE1BC,SAAS;IACTC,WAAW,EAAGjB,CAAC,IAAKD,eAAe,CAACC,CAAC,EAAEC,KAAK,CAAE;IAC9CiB,UAAU,EAAEd,cAAe;IAC3BlC,MAAM,EAAG8B,CAAC,IAAKM,UAAU,CAACN,CAAC,EAAEC,KAAK,CAAE;IAAAkB,QAAA,gBAEpC1D,OAAA;MAAA0D,QAAA,eACE1D,OAAA;QAAK2D,GAAG,EAAE,kCAAkC,GAAG7C,IAAI,CAACY,OAAQ;QAACkC,GAAG,EAAE9C,IAAI,CAACa,IAAK;QAACkC,KAAK,EAAE;UAAEC,KAAK,EAAE,MAAM;UAAEC,MAAM,EAAE;QAAO;MAAE;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAE;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACtH,CAAC,eAENnE,OAAA;MAAQsD,SAAS,EAAC,kBAAkB;MAACc,OAAO,EAAEA,CAAA,KAAMnC,UAAU,CAACnB,IAAI,CAACa,IAAI;IAAE;MAAAqC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAS,CAAC;EAAA,GAV/ErD,IAAI,CAACY,OAAO;IAAAsC,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAWd,CACN,CAAC;EAEF,MAAMvC,MAAM,GAAGvB,eAAe,CAACgD,GAAG,CAAC,CAACgB,KAAK,EAAE7B,KAAK,kBAC5CxC,OAAA;IAAK6D,KAAK,EAAE;MAACS,eAAe,EAAED;IAAK,CAAE;IAAC,WAASA;EAAM,GAAM7B,KAAK;IAAAwB,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAAO,CAC1E,CAAC;EAEF,oBACEnE,OAAA;IAAA0D,QAAA,gBACE1D,OAAA;MAAA,GAASmC,YAAY,CAAC;QAAEmB,SAAS,EAAE;MAAW,CAAC,CAAC;MAAAI,QAAA,gBAC9C1D,OAAA;QAAA,GAAWoC,aAAa,CAAC;MAAC;QAAA4B,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAG,CAAC,eAC9BnE,OAAA;QAAA0D,QAAA,EAAG;MAAkC;QAAAM,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAG,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACtC,CAAC,eACJnE,OAAA;MAAOsD,SAAS,EAAC,eAAe;MAACO,KAAK,EAAE;QAAEU,SAAS,EAAE;MAAO,CAAE;MAAAb,QAAA,GAC7DnD,aAAa,iBACZP,OAAA;QAAKsD,SAAS,EAAC,SAAS;QAAAI,QAAA,gBACtB1D,OAAA;UAAK2D,GAAG,EAAElE;QAAQ;UAAAuE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE,CAAC,+EACvB;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAK,CACN,EACAf,MAAM;IAAA;MAAAY,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACF,CAAC,eAEVnE,OAAA;MAAKsD,SAAS,EAAC,iBAAiB;MAAAI,QAAA,EAC7B9B;IAAM;MAAAoC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACJ,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACD,CAAC;AAEV;AAACjE,EAAA,CApHQD,YAAY;EAAA,QAqDqBH,WAAW;AAAA;AAAA0E,EAAA,GArD5CvE,YAAY;AAoHpB;AAED,eAAeA,YAAY;AAAC,IAAAuE,EAAA;AAAAC,YAAA,CAAAD,EAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}