{"ast":null,"code":"import'./OneStepPopup.css';import{useEffect,useState,useContext}from\"react\";import{useLocation}from'react-router-dom';import{CurrentUserContext}from'../../../contexts/CurrentUserContext';import usersApi from'../../../utils/UsersApi';import sparkle from'../../../images/sparkle-success.svg';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function OneStepPopup(_ref){let{cart,productId,isLoggedIn,isOpen,onClose}=_ref;const currentUser=useContext(CurrentUserContext);// console.log(isOpen);\nconst location=useLocation();const[name,setName]=useState(\"\");const[phone,setPhone]=useState(\"\");// const [email, setEmail] = useState(\"\");\nconst[comment,setcomment]=useState(\"\");const[isConsent,setIsConsent]=useState(true);const[isSubmitting,setIsSubmitting]=useState(false);const[orderId,setOrderId]=useState('');const[isSuccess,setIsSuccess]=useState(false);function handleOrderSubmit(e){e.preventDefault();setIsSubmitting(true);const orderData={name:name,phone:phone,email:currentUser.email,comment:comment,userId:currentUser.userId,cart:cart,productId:productId};// console.log(orderData)\nusersApi.addQuickOrder(orderData).then(res=>{// console.log(res)\nsetOrderId(res.orderId);setIsSuccess(true);}).then(()=>{if(location.pathname==='/cart'){if(isLoggedIn){usersApi.updateCart(JSON.stringify({}));}localStorage.removeItem('cart');}}).catch(err=>{console.log(err);});}function handleConsent(){setIsConsent(!isConsent);// console.log(isConsent)\n}useEffect(()=>{setIsSuccess(false);},[productId]);return/*#__PURE__*/_jsx(\"div\",{className:isOpen?'onestep-popup_active':'onestep-popup',children:/*#__PURE__*/_jsx(\"div\",{className:\"onestep__overlay\",children:isSuccess?/*#__PURE__*/_jsxs(\"div\",{className:\"onestep__content\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:onClose,className:\"onestep__close-button\"}),/*#__PURE__*/_jsx(\"div\",{className:\"onestep__success\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"onestep__success-text\",children:[\"\\u0411\\u044B\\u0441\\u0442\\u0440\\u044B\\u0439 \\u0437\\u0430\\u043A\\u0430\\u0437 \\u2116\",orderId,\" \\u043E\\u0444\\u043E\\u0440\\u043C\\u043B\\u0435\\u043D \\u0443\\u0441\\u043F\\u0435\\u0448\\u043D\\u043E! \\u0412 \\u0431\\u043B\\u0438\\u0436\\u0430\\u0439\\u0448\\u0435\\u0435 \\u0432\\u0440\\u0435\\u043C\\u044F \\u043C\\u044B \\u0412\\u0430\\u043C \\u043F\\u0435\\u0440\\u0435\\u0437\\u0432\\u043E\\u043D\\u0438\\u043C! \",/*#__PURE__*/_jsx(\"img\",{style:{marginLeft:'8px',width:'26px'},src:sparkle})]})}),/*#__PURE__*/_jsx(\"p\",{className:\"onestep__hours\",children:\"\\u0427\\u0430\\u0441\\u044B \\u0440\\u0430\\u0431\\u043E\\u0442\\u044B: \\u041F\\u043D-\\u041F\\u0442 08:00 \\u2014 17:00 (\\u043F\\u043E \\u041C\\u043E\\u0441\\u043A\\u0432\\u0435)\"})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"onestep__content\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:onClose,className:\"onestep__close-button\"}),/*#__PURE__*/_jsx(\"h2\",{className:\"onestep__header\",children:\"\\u0417\\u0430\\u043A\\u0430\\u0437 \\u0432 1 \\u043A\\u043B\\u0438\\u043A\"}),/*#__PURE__*/_jsxs(\"form\",{className:\"onestep__form\",onSubmit:handleOrderSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"onestep__form-flex\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"phone\",children:\"\\u0422\\u0435\\u043B\\u0435\\u0444\\u043E\\u043D*\"}),/*#__PURE__*/_jsx(\"input\",{className:\"onestep__input\",type:\"tel\",placeholder:\"\\u041D\\u0443\\u0436\\u0435\\u043D \\u0434\\u043B\\u044F \\u043E\\u0444\\u043E\\u0440\\u043C\\u043B\\u0435\\u043D\\u0438\\u044F \\u0437\\u0430\\u043A\\u0430\\u0437\\u0430\",name:\"phone\",value:phone||'',onChange:e=>setPhone(e.target.value),required:true,minLength:10,maxLength:20})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"onestep__form-flex\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"name\",children:\"\\u0418\\u043C\\u044F*\"}),/*#__PURE__*/_jsx(\"input\",{className:\"onestep__input\",type:\"text\",name:\"name\",value:name||'',placeholder:\"\\u041A\\u0430\\u043A \\u043A \\u0412\\u0430\\u043C \\u043E\\u0431\\u0440\\u0430\\u0449\\u0430\\u0442\\u044C\\u0441\\u044F?\",onChange:e=>setName(e.target.value),required:true,minLength:3,maxLength:20})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"onestep__form-flex\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u0414\\u043E\\u043F\\u043E\\u043B\\u043D\\u0438\\u0442\\u0435\\u043B\\u044C\\u043D\\u0430\\u044F \\u0438\\u043D\\u0444\\u043E\\u0440\\u043C\\u0430\\u0446\\u0438\\u044F\"}),/*#__PURE__*/_jsx(\"textarea\",{className:\"onestep__textarea\",value:comment||'',onChange:e=>setcomment(e.target.value)// required\n,placeholder:\"\\u041D\\u0430\\u043F\\u0440\\u0438\\u043C\\u0435\\u0440, \\u0412\\u0430\\u0448 \\u0433\\u043E\\u0440\\u043E\\u0434, email\",maxLength:100})]}),/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"license\",className:\"callback-label cart__sum-caption\",style:{marginBottom:'0'},children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",name:\"license\",id:\"license\",className:\"callback-input\",checked:isConsent,onChange:handleConsent}),\"\\u042F \\u0434\\u0430\\u044E \\u0441\\u043E\\u0433\\u043B\\u0430\\u0441\\u0438\\u0435 \\u043D\\u0430 \\u043E\\u0431\\u0440\\u0430\\u0431\\u043E\\u0442\\u043A\\u0443 \\u043F\\u0435\\u0440\\u0441\\u043E\\u043D\\u0430\\u043B\\u044C\\u043D\\u044B\\u0445 \\u0434\\u0430\\u043D\\u043D\\u044B\\u0445.\"]}),/*#__PURE__*/_jsx(\"button\",{className:isSubmitting?'onestep__submit-button':'onestep__submit-button',type:\"submit\",disabled:!isConsent||isSubmitting,children:\"\\u0417\\u0430\\u043A\\u0430\\u0437\\u0430\\u0442\\u044C\"})]})]})})});}","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}