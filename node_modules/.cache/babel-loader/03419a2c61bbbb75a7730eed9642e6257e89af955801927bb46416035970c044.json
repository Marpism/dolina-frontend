{"ast":null,"code":"import'./ShoppingCart.css';import Header from'../Header/Header';import MobileNavBar from'../MobileNavBar/MobileNavBar';import CartProduct from'./CartProduct/CartProduct';import productsApi from\"../../utils/Api\";import OneStepPopup from'../Product/OneStepPopup/OneStepPopup';import{useEffect,useState}from'react';import{useMediaQuery}from'react-responsive';import{useNavigate}from'react-router-dom';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function ShoppingCart(_ref){let{cart,onCardClick,onRemoveClick,savedProducts,onLikeClick,terms,onCatClick,category,onBurgerClick,onBurgerClose,isBurgerOpen,search,setSearch,isLoggedIn}=_ref;useEffect(()=>{document.title='Корзина — Долина самоцветов';},[]);const navigate=useNavigate();const[cartProducts,setCartProducts]=useState([]);const[total,setTotal]=useState(0);const[totalWithDiscount,setTotalWithDiscount]=useState(0);const[shopDiscount,setShopDiscount]=useState(0);const[isOrderOpen,setIsOrderOpen]=useState(false);useEffect(()=>{if(cart&&Object.keys(cart).length>0){const productIds=Object.keys(cart);productsApi.getProductsById([productIds]).then(res=>{setCartProducts(res);}).catch(err=>console.log(err));}else{setCartProducts([]);}},[cart]);useEffect(()=>{let sum=0;let withDiscount=0;cartProducts.forEach(product=>{if(product.inStock>0){var _product$salePrice;sum+=product.price;withDiscount+=(_product$salePrice=product.salePrice)!==null&&_product$salePrice!==void 0?_product$salePrice:product.price;}else{sum+=0;}});setTotal(sum);setTotalWithDiscount(withDiscount);setShopDiscount(sum-withDiscount);// console.log(cartProducts)\n},[cartProducts]);// Re-run the effect only when cartProducts change)\nconst isBigScreen=useMediaQuery({minWidth:768});// надо бы перенести в константы\nconst isSmallScreen=useMediaQuery({maxWidth:767});function proceedToOrderingPage(event){event.preventDefault();if(isLoggedIn){navigate('/ordering');}else{navigate('/signup');}}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"main\",{className:\"cart flex_type_column\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"cart__header\",children:\"\\u041A\\u043E\\u0440\\u0437\\u0438\\u043D\\u0430\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"cart-container_1\",children:[/*#__PURE__*/_jsx(\"section\",{className:\"cart__products\",children:/*#__PURE__*/_jsx(\"ul\",{className:\"cart__product-list\",children:cartProducts.length>0?cartProducts.map(product=>{var _product$salePrice2;return/*#__PURE__*/_jsx(CartProduct,{name:product.title,price:product.price,salePrice:(_product$salePrice2=product.salePrice)!==null&&_product$salePrice2!==void 0?_product$salePrice2:0,onCardClick:onCardClick,id:product.productId,pictures:product.pictures,sku:product.SKU,cartDetails:cart[product.productId],onRemoveClick:onRemoveClick,savedProducts:savedProducts,onLikeClick:onLikeClick,inStock:product.inStock// index={index}\n// onCheckboxClick={handleCheckboxClick}\n},product.productId);}):/*#__PURE__*/_jsxs(_Fragment,{children:[\"\\u041A\\u043E\\u0440\\u0437\\u0438\\u043D\\u0430 \\u043F\\u043E\\u043A\\u0430 \\u043F\\u0443\\u0441\\u0442\\u0430\\u044F. \\u0417\\u0430\\u0433\\u043B\\u044F\\u043D\\u0438\\u0442\\u0435 \\u0432 \",/*#__PURE__*/_jsx(\"a\",{href:\"/catalog/\",style:{color:'black'},children:\"\\u043A\\u0430\\u0442\\u0430\\u043B\\u043E\\u0433\"}),\"\\u2728\"]})})}),isBigScreen&&/*#__PURE__*/_jsx(\"div\",{className:\"cart__summary\",children:/*#__PURE__*/_jsxs(\"form\",{className:\"cart__form\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"cart__subheader\",children:\"\\u0421\\u0443\\u043C\\u043C\\u0430 \\u0437\\u0430\\u043A\\u0430\\u0437\\u0430\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"cart-container_2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"cart__sum-text\",children:[\"\\u0422\\u043E\\u0432\\u0430\\u0440\\u044B (\",cartProducts.length,\")\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"cart__sum-text\",children:[total,\" \\u20BD\"]})]}),shopDiscount?/*#__PURE__*/_jsxs(\"div\",{className:\"cart-container_2\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"cart__sum-text\",children:\"\\u0421\\u043A\\u0438\\u0434\\u043A\\u0430 \\u043C\\u0430\\u0433\\u0430\\u0437\\u0438\\u043D\\u0430\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"cart__sum-text\",children:[\"- \",shopDiscount,\" \\u20BD\"]})]}):null,/*#__PURE__*/_jsxs(\"div\",{className:\"cart-container_2\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"cart__sum-header\",children:\"\\u0418\\u0442\\u043E\\u0433\\u043E:\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"cart__sum\",children:[totalWithDiscount,\" \\u20BD\"]})]}),/*#__PURE__*/_jsx(\"p\",{className:\"cart__sum-caption\",children:\"\\u0411\\u0435\\u0437 \\u0443\\u0447\\u0435\\u0442\\u0430 \\u0441\\u0442\\u043E\\u0438\\u043C\\u043E\\u0441\\u0442\\u0438 \\u0434\\u043E\\u0441\\u0442\\u0430\\u0432\\u043A\\u0438\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",onClick:proceedToOrderingPage,name:\"cart-submit\",className:\"cart__submit-button hover_type_normal pointer\",disabled:cartProducts.length==0||total===0,children:cartProducts.length>0?'Перейти к оформлению':'В корзине нет товаров'}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:setIsOrderOpen,name:\"cart-onestep\",className:cartProducts.length>0?'cart__onestep-button hover_type_normal pointer':'cart__onestep-button_hidden',disabled:cartProducts.length==0||total===0,children:\"\\u0417\\u0430\\u043A\\u0430\\u0437 \\u0432 1 \\u043A\\u043B\\u0438\\u043A\"})]})}),isSmallScreen&&/*#__PURE__*/_jsx(\"div\",{className:\"cart__summary\",children:/*#__PURE__*/_jsxs(\"form\",{className:\"cart__form\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"cart__subheader\",children:\"\\u0421\\u0443\\u043C\\u043C\\u0430 \\u0437\\u0430\\u043A\\u0430\\u0437\\u0430\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"cart-container_2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"cart__sum-text\",children:[\"\\u0422\\u043E\\u0432\\u0430\\u0440\\u044B (\",cartProducts.length,\")\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"cart__sum-text\",children:[total,\" \\u20BD\"]})]}),shopDiscount?/*#__PURE__*/_jsxs(\"div\",{className:\"cart-container_2\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"cart__sum-text\",children:\"\\u0421\\u043A\\u0438\\u0434\\u043A\\u0430 \\u043C\\u0430\\u0433\\u0430\\u0437\\u0438\\u043D\\u0430\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"cart__sum-text\",children:[\"- \",shopDiscount,\" \\u20BD\"]})]}):null,/*#__PURE__*/_jsxs(\"div\",{className:\"cart-container_2\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"cart__sum-header\",children:\"\\u0418\\u0442\\u043E\\u0433\\u043E:\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"cart__sum\",children:[totalWithDiscount,\" \\u20BD\"]})]}),/*#__PURE__*/_jsx(\"p\",{className:\"cart__sum-caption\",children:\"\\u0411\\u0435\\u0437 \\u0443\\u0447\\u0435\\u0442\\u0430 \\u0441\\u0442\\u043E\\u0438\\u043C\\u043E\\u0441\\u0442\\u0438 \\u0434\\u043E\\u0441\\u0442\\u0430\\u0432\\u043A\\u0438\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",onClick:proceedToOrderingPage,name:\"cart-submit\",className:\"cart__submit-button hover_type_normal pointer\",disabled:cartProducts.length==0||total===0,children:cartProducts.length>0?'Перейти к оформлению':'В корзине нет товаров'}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:setIsOrderOpen,name:\"cart-onestep\",className:cartProducts.length>0?'cart__onestep-button hover_type_normal pointer':'cart__onestep-button_hidden',disabled:cartProducts.length==0||total===0,children:\"\\u0417\\u0430\\u043A\\u0430\\u0437\\u0430\\u0442\\u044C \\u0432 1 \\u043A\\u043B\\u0438\\u043A\"})]})})]}),/*#__PURE__*/_jsx(OneStepPopup,{productId:null,cart:cart,isLoggedIn:isLoggedIn,isOpen:isOrderOpen,onClose:()=>setIsOrderOpen(false)})]}),/*#__PURE__*/_jsx(MobileNavBar,{onBurger:onBurgerClick,isBurgerOpen:isBurgerOpen,onBurgerClose:onBurgerClose,onCatClick:onCatClick,cart:cart,isLoggedIn:isLoggedIn})]});}// Не реализовано:\n//  - работа чекбоксов\n//  - скидка\n//  - глав-чекбокс\n//  - кнопки в избранное и удалить","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}