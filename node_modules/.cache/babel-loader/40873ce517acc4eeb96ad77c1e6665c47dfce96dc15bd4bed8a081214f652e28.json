{"ast":null,"code":"import'./Profile.css';import Header from'../Header/Header';import MobileNavBar from\"../MobileNavBar/MobileNavBar\";import productsApi from'../../utils/Api';import ProfilePopup from'./ProfilePopup';import{useNavigate,NavLink}from'react-router-dom';import{useMediaQuery}from'react-responsive';import{useState,useEffect,useContext}from\"react\";import{CurrentUserContext}from'../../contexts/CurrentUserContext';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export default function Profile(_ref){var _currentUser$name;let{savedProducts,orders,onUpdateUser,onSignout,onChangeClick,onCloseClick,isPopupOpen,terms,onCatClick,onBurgerClick,onBurgerClose,isBurgerOpen,search,setSearch,cart,isLoggedIn}=_ref;// const isBigScreen = useMediaQuery({ minWidth: 768 }); // надо бы перенести в константы\n// const isSmallScreen = useMediaQuery({ maxWidth: 767 });\nuseEffect(()=>{document.title='Мой профиль — Долина самоцветов';},[]);const currentUser=useContext(CurrentUserContext);// const [isProfilePopupOpen, setIsProfilePopupOpen] = useState(false);\nconst[wishlist,setWishlist]=useState([]);// const [userName, setUserName] = useState(currentUser.name);\n// const [userMail, setUserMail] = useState(currentUser.email);\nlet wishlistPreviews=wishlist.slice(-4);let ordersPreviews=orders.slice(0,1);// function signOutAndPopup() {\n// }\nfunction getDate(timestamp){return new Date(timestamp*1000).toLocaleDateString('ru-RU');}const getStatusName=index=>{switch(index){case 0:return'Новый';case 1:return'Собираем заказ';case 2:return'В пути';case 3:return'Доставлен';case-1:return'Отменён';default:return'';}};const getStatusClass=index=>{switch(index){case 0:return'status-new';case 1:return'status-collecting';case 2:return'status-on-the-way';case 3:return'status-delivered';case-1:return'status-cancelled';default:return'';}};useEffect(()=>{productsApi.getProductsById([savedProducts]).then(res=>{setWishlist(res);// console.log(res)\n}).catch(err=>console.log(err));},[savedProducts]);const getDeliveryTypeName=index=>{switch(index){case 1:return'Пункт выдачи СДЭК';case 2:return'Курьерская доставка СДЭК';case 3:return'Почта';case 4:return'Пункт выдачи Boxberry';case 5:return'Курьерская доставка Boxberry';case 6:return'5post';default:return'';}};// useEffect(() => {\n//   console.log(isPopupOpen);\n// }, [isPopupOpen]);\n// useEffect(() => {\n//   setUserName(currentUser.name);\n//   setUserMail(currentUser.email);\n// }, [currentUser]);\n// function onChangeClick2() {\n//   onChangeClick();\n// }\nreturn/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"main\",{className:\"profile\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"wishlist-header\",children:\"\\u041B\\u0438\\u0447\\u043D\\u044B\\u0439 \\u043A\\u0430\\u0431\\u0438\\u043D\\u0435\\u0442\"}),/*#__PURE__*/_jsxs(\"section\",{className:\"user-info\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"user-info__avatar\",children:/*#__PURE__*/_jsx(\"p\",{className:\"user-info__avatar-caption\",children:currentUser===null||currentUser===void 0?void 0:(_currentUser$name=currentUser.name)===null||_currentUser$name===void 0?void 0:_currentUser$name.slice(0,1)})}),/*#__PURE__*/_jsxs(\"div\",{className:\"user-info__container\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"user-info__name\",children:currentUser.name}),/*#__PURE__*/_jsx(\"p\",{className:\"user-info__email\",children:currentUser.email}),/*#__PURE__*/_jsx(NavLink,{to:\"\",onClick:onChangeClick,className:\"navlink_size_s \",children:\"\\u0420\\u0435\\u0434\\u0430\\u043A\\u0442\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C \"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"profile_flex\",children:[/*#__PURE__*/_jsx(\"section\",{className:\"profile__orders\",children:/*#__PURE__*/_jsxs(NavLink,{to:\"/me/orders\",className:\"profile__link\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"profile__subheader\",children:\"\\u0417\\u0430\\u043A\\u0430\\u0437\\u044B \\u2192\"}),/*#__PURE__*/_jsx(\"ul\",{className:\"profile__orders_ul\",children:ordersPreviews.map(order=>/*#__PURE__*/ // <li className='order' key={order.orderId} style={{margin: '0'}}>\n//   <div className='flex_type_row order__head'>\n//     <h3 className='order__header'>Заказ №{order.orderId} от {getDate(order.createdAt)}</h3>\n//     <p className='order__price'>{order.totalPrice} &#8381;</p>\n//   </div>\n//   <div className='flex_type_row order__body' style={{padding: '10px'}}>\n//     <div className=''>\n//       {/* <p className='order__status'>{order.orderStatus === 0 ? \"Создан\" : \"нет\"}</p> */}\n//       <p className={`order__status ${getStatusClass(order.orderStatus)}`} style={{marginLeft:'15px'}}>{getStatusName(order.orderStatus)}</p>\n//       {order.tracking > 0 ? (\n//         <p className='order__main-text'>Трек-номер: <span className='order_tracking-number'>{order.tracking}</span></p>\n//       ) : (\n//         null\n//       )}\n//     </div>\n//     <div className='order__products'>\n//       {order.orderedProducts.slice(0, 3).map((product) => (\n//         <img className='order__pic_mini' alt={product.title} src={`https://dolina.shop/photos/${product.path.slice(0, -4) + `_preview.jpg`}`}></img>\n//       ))}\n//     </div>\n//   </div>\n// </li>\n_jsxs(\"li\",{className:\"order\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex_type_row order__head\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"order__header\",children:[\"\\u0417\\u0430\\u043A\\u0430\\u0437 \\u043E\\u0442 \",getDate(order.createdAt)]}),/*#__PURE__*/_jsxs(\"p\",{className:\"order__total-price\",children:[order.totalPrice+order.deliveryPrice,\" \\u20BD\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"order__body\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"order__main-info\",style:{width:'100%',border:'none'},children:[/*#__PURE__*/_jsxs(\"p\",{className:\"order__main-text\",children:[getDeliveryTypeName(order.deliveryType),\": \",order.deliveryOffice?order.deliveryOffice:\"\".concat(order.city+', '+order.deliveryAddress)]}),/*#__PURE__*/_jsxs(\"p\",{className:\"order__main-text\",children:[\"\\u0421\\u0442\\u043E\\u0438\\u043C\\u043E\\u0441\\u0442\\u044C \\u0434\\u043E\\u0441\\u0442\\u0430\\u0432\\u043A\\u0438: \",order.deliveryPrice,\" \\u20BD\"]}),order.orderStatus===4?null:order.paid===1?/*#__PURE__*/_jsx(\"p\",{className:\"order_paid\",children:\"\\u041E\\u043F\\u043B\\u0430\\u0447\\u0435\\u043D\"}):order.paymentType!==3?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"p\",{className:\"order_not-paid\",children:\"\\u041D\\u0435 \\u043E\\u043F\\u043B\\u0430\\u0447\\u0435\\u043D\"}),/*#__PURE__*/_jsx(\"span\",{className:\"orders_pay\",children:\"\\u041E\\u043F\\u043B\\u0430\\u0442\\u0438\\u0442\\u044C\"})]}):/*#__PURE__*/_jsx(\"p\",{className:\"order_not-paid\",children:\"\\u041D\\u0435 \\u043E\\u043F\\u043B\\u0430\\u0447\\u0435\\u043D\"}),/*#__PURE__*/_jsx(\"p\",{className:\"order__status \".concat(getStatusClass(order.orderStatus)),children:getStatusName(order.orderStatus)})]})})]},order.orderId))})]})}),/*#__PURE__*/_jsx(\"section\",{className:\"profile__wishlist\",children:/*#__PURE__*/_jsxs(NavLink,{to:\"/me/wishlist\",className:\"profile__link\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"profile__subheader\",children:\"\\u0418\\u0437\\u0431\\u0440\\u0430\\u043D\\u043D\\u043E\\u0435 \\u2192\"}),/*#__PURE__*/_jsxs(\"ul\",{className:\"profile__wishlist_ul\",children:[wishlistPreviews.map(product=>/*#__PURE__*/_jsx(\"li\",{className:\"profile__wishlist_li\",children:/*#__PURE__*/_jsx(\"img\",{className:\"profile__wishlist-pic\",src:\"https://dolina.shop/photos/\".concat(product.pictures[0].path.slice(0,-4)+\"_preview.jpg\")})},product.pictures[0].path)),wishlist.length>4&&/*#__PURE__*/_jsx(\"li\",{className:\"profile__wishlist_li\",children:\"+\".concat(savedProducts.length-4)})]})]})})]}),/*#__PURE__*/_jsx(ProfilePopup,{isOpen:isPopupOpen,onClose:onCloseClick,onUpdateUser:onUpdateUser,onSignout:onSignout}),/*#__PURE__*/_jsx(MobileNavBar,{onBurger:onBurgerClick,isBurgerOpen:isBurgerOpen,onBurgerClose:onBurgerClose,cart:cart,orders:orders,onCatClick:onCatClick,isLoggedIn:isLoggedIn})]})});}// Что должно быть:\n// - имя, почта, телефон\n// - выйти из профиля\n// - избранное\n// - заказы\n// - ожидаемые доставки?\n// - недавно просмотренные","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}