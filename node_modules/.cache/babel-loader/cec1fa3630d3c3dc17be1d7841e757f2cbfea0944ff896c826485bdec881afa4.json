{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Maria\\\\Desktop\\\\Coding\\\\01dolina\\\\dolina_frontend\\\\src\\\\components\\\\pages\\\\ProductPage.js\",\n  _s = $RefreshSig$();\nimport Crumbs from \"../Crumbs/Crumbs\";\nimport Product from \"../Product/Product\";\nimport MobileNavBar from \"../MobileNavBar/MobileNavBar\";\nimport { useParams } from 'react-router-dom';\nimport { useEffect, useState } from 'react';\nimport productsApi from '../../utils/Api';\nimport Skeleton from 'react-loading-skeleton';\nimport 'react-loading-skeleton/dist/skeleton.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default function ProductPage({\n  onLikeClick,\n  savedProducts,\n  onAddClick,\n  isLoggedIn,\n  cart,\n  onCardClick,\n  terms,\n  onCatClick,\n  onBurgerClick,\n  onBurgerClose,\n  isBurgerOpen,\n  search,\n  setSearch,\n  orders,\n  stoneDescriptions\n}) {\n  _s();\n  const {\n    newSlug\n  } = useParams();\n  let lastIndex = newSlug.lastIndexOf(\"-\");\n  let productId = newSlug.substring(lastIndex + 1); // or str.slice(lastIndex + 1);\n\n  const [productData, setProductData] = useState(null);\n  const [matchedStoneDescriptions, setMatchedStoneDescriptions] = useState([]);\n  useEffect(() => {\n    productsApi.getProduct(productId).then(data => {\n      setProductData(data[0]);\n    }).catch(error => console.error('Error fetching product:', error));\n  }, [newSlug, productId]);\n\n  // useEffect(() => {\n  //   if (productData) {\n  //     const productTags = productData.tags || [];\n  //     const matchedDescriptions = stoneDescriptions.filter(description =>\n  //       description.tags.every(tag => productTags.includes(tag))\n  //     );\n  //     setMatchedStoneDescriptions(matchedDescriptions);\n  //   }\n  // }, [productData, stoneDescriptions]);\n\n  // useEffect(() => {\n  //   if (productData) {\n  //     const productTags = JSON.parse(productData.tags || \"[]\");\n  //     const matchedDescriptions = stoneDescriptions.filter(({ tags }) => {\n  //       const descriptionTags = JSON.parse(tags || \"[]\");\n  //       return descriptionTags.every(tag => productTags.includes(tag));\n  //     });\n  //     setMatchedStoneDescriptions(matchedDescriptions);\n  //   }\n  // }, [productData, stoneDescriptions]);\n\n  useEffect(() => {\n    if (productData) {\n      // Преобразование строки тэгов продукта в массив\n      let productTags = [];\n      if (typeof productData.tags === 'string') {\n        try {\n          productTags = JSON.parse(productData.tags);\n        } catch (error) {\n          console.error('Error parsing product tags:', error, productData.tags);\n        }\n      }\n      const matchedDescriptions = stoneDescriptions.filter(({\n        tags\n      }) => {\n        // Преобразование строки тэгов описания в массив\n        let descriptionTags = [];\n        if (typeof tags === 'string') {\n          try {\n            descriptionTags = JSON.parse(tags);\n          } catch (error) {\n            console.warn('Error parsing description tags:', error, tags);\n            return false;\n          }\n        }\n        // Сравнение тэгов описания и тэгов продукта\n        return descriptionTags.every(tag => productTags.includes(tag));\n      });\n      setMatchedStoneDescriptions(matchedDescriptions);\n    }\n  }, [productData, stoneDescriptions]);\n  if (!productData) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        minHeight: '200vh'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          justifyContent: 'space-between'\n        },\n        children: [/*#__PURE__*/_jsxDEV(Skeleton, {\n          height: 515,\n          width: 480\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 83,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(Skeleton, {\n          height: 500,\n          width: 300\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 84,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(Skeleton, {\n          height: 400,\n          width: 300\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 85,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Skeleton, {\n        style: {\n          margin: '50px 0 40px 0'\n        },\n        height: 20,\n        width: 300\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Skeleton, {\n        count: 3\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Skeleton, {\n        style: {\n          margin: '40px 0'\n        },\n        height: 20,\n        width: 300\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Product, {\n      productData: productData,\n      salePrice: productData.salePrice,\n      onLikeClick: onLikeClick,\n      savedProducts: savedProducts,\n      onAddClick: onAddClick,\n      isLoggedIn: isLoggedIn,\n      cart: cart,\n      onCardClick: onCardClick,\n      stoneDescriptions: matchedStoneDescriptions\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(MobileNavBar, {\n      onBurger: onBurgerClick,\n      isBurgerOpen: isBurgerOpen,\n      onBurgerClose: onBurgerClose,\n      cart: cart,\n      onCatClick: onCatClick,\n      orders: orders\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 5\n    }, this)]\n  }, void 0, true);\n}\n_s(ProductPage, \"t22Jbi23Ju5C1xFTKWZYTzxutUY=\", false, function () {\n  return [useParams];\n});\n_c = ProductPage;\nvar _c;\n$RefreshReg$(_c, \"ProductPage\");","map":{"version":3,"names":["Crumbs","Product","MobileNavBar","useParams","useEffect","useState","productsApi","Skeleton","jsxDEV","_jsxDEV","Fragment","_Fragment","ProductPage","onLikeClick","savedProducts","onAddClick","isLoggedIn","cart","onCardClick","terms","onCatClick","onBurgerClick","onBurgerClose","isBurgerOpen","search","setSearch","orders","stoneDescriptions","_s","newSlug","lastIndex","lastIndexOf","productId","substring","productData","setProductData","matchedStoneDescriptions","setMatchedStoneDescriptions","getProduct","then","data","catch","error","console","productTags","tags","JSON","parse","matchedDescriptions","filter","descriptionTags","warn","every","tag","includes","style","minHeight","children","display","justifyContent","height","width","fileName","_jsxFileName","lineNumber","columnNumber","margin","count","salePrice","onBurger","_c","$RefreshReg$"],"sources":["C:/Users/Maria/Desktop/Coding/01dolina/dolina_frontend/src/components/pages/ProductPage.js"],"sourcesContent":["import Crumbs from \"../Crumbs/Crumbs\";\r\nimport Product from \"../Product/Product\";\r\nimport MobileNavBar from \"../MobileNavBar/MobileNavBar\";\r\nimport { useParams } from 'react-router-dom';\r\nimport { useEffect, useState } from 'react';\r\nimport productsApi from '../../utils/Api';\r\nimport Skeleton from 'react-loading-skeleton';\r\nimport 'react-loading-skeleton/dist/skeleton.css';\r\n\r\nexport default function ProductPage({ onLikeClick, savedProducts, onAddClick, isLoggedIn, cart, onCardClick, terms, onCatClick, onBurgerClick, onBurgerClose, isBurgerOpen, search, setSearch, orders, stoneDescriptions }) {\r\n\r\n  const { newSlug } = useParams();\r\n\r\n  let lastIndex = newSlug.lastIndexOf(\"-\");\r\n  let productId = newSlug.substring(lastIndex + 1); // or str.slice(lastIndex + 1);\r\n\r\n  const [productData, setProductData] = useState(null);\r\n  const [matchedStoneDescriptions, setMatchedStoneDescriptions] = useState([]);\r\n\r\n  useEffect(() => {\r\n      productsApi.getProduct(productId)\r\n          .then((data) => { setProductData(data[0]); })\r\n          .catch((error) => console.error('Error fetching product:', error));\r\n  }, [newSlug, productId]);\r\n\r\n  // useEffect(() => {\r\n  //   if (productData) {\r\n  //     const productTags = productData.tags || [];\r\n  //     const matchedDescriptions = stoneDescriptions.filter(description =>\r\n  //       description.tags.every(tag => productTags.includes(tag))\r\n  //     );\r\n  //     setMatchedStoneDescriptions(matchedDescriptions);\r\n  //   }\r\n  // }, [productData, stoneDescriptions]);\r\n\r\n  \r\n  // useEffect(() => {\r\n  //   if (productData) {\r\n  //     const productTags = JSON.parse(productData.tags || \"[]\");\r\n  //     const matchedDescriptions = stoneDescriptions.filter(({ tags }) => {\r\n  //       const descriptionTags = JSON.parse(tags || \"[]\");\r\n  //       return descriptionTags.every(tag => productTags.includes(tag));\r\n  //     });\r\n  //     setMatchedStoneDescriptions(matchedDescriptions);\r\n  //   }\r\n  // }, [productData, stoneDescriptions]);\r\n\r\n  useEffect(() => {\r\n    if (productData) {\r\n      // Преобразование строки тэгов продукта в массив\r\n      let productTags = [];\r\n      if (typeof productData.tags === 'string') {\r\n        try {\r\n          productTags = JSON.parse(productData.tags);\r\n        } catch (error) {\r\n          console.error('Error parsing product tags:', error, productData.tags);\r\n        }\r\n      }\r\n\r\n      const matchedDescriptions = stoneDescriptions.filter(({ tags }) => {\r\n        // Преобразование строки тэгов описания в массив\r\n        let descriptionTags = [];\r\n        if (typeof tags === 'string') {\r\n          try {\r\n            descriptionTags = JSON.parse(tags);\r\n          } catch (error) {\r\n            console.warn('Error parsing description tags:', error, tags);\r\n            return false;\r\n          }\r\n        }\r\n        // Сравнение тэгов описания и тэгов продукта\r\n        return descriptionTags.every(tag => productTags.includes(tag));\r\n      });\r\n\r\n      setMatchedStoneDescriptions(matchedDescriptions);\r\n    }\r\n  }, [productData, stoneDescriptions]);\r\n\r\n  if (!productData) {\r\n    return (\r\n      <div style={{minHeight: '200vh'}}>\r\n        <div style={{display: 'flex', justifyContent: 'space-between'}}>\r\n        <Skeleton height={515} width={480} />\r\n        <Skeleton height={500} width={300} />\r\n        <Skeleton height={400} width={300} />\r\n        </div>\r\n        <Skeleton style={{margin: '50px 0 40px 0'}} height={20} width={300} />\r\n        <Skeleton count={3} />\r\n        <Skeleton style={{margin: '40px 0'}} height={20} width={300} />\r\n \r\n        \r\n      </div>\r\n    );\r\n  }\r\n\r\n\r\n  return (\r\n    <>\r\n    \r\n    {/* <Crumbs/> */}\r\n    <Product\r\n      productData={productData}\r\n      salePrice={productData.salePrice}\r\n      onLikeClick={onLikeClick}\r\n      savedProducts={savedProducts}\r\n      onAddClick={onAddClick}\r\n      isLoggedIn={isLoggedIn}\r\n      cart={cart}\r\n      onCardClick={onCardClick}\r\n      stoneDescriptions={matchedStoneDescriptions}\r\n    ></Product>\r\n    <MobileNavBar\r\n    onBurger={onBurgerClick} \r\n    isBurgerOpen={isBurgerOpen} \r\n    onBurgerClose={onBurgerClose}\r\n    cart={cart}\r\n    onCatClick={onCatClick}\r\n    orders={orders}/>\r\n    </>\r\n  )\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}