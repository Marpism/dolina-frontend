{"ast":null,"code":"class UsersApi {\n  constructor(options) {\n    this._url = options.url;\n    this._headers = options.headers;\n  }\n  _getResponseData(res) {\n    if (!res.ok) {\n      return Promise.reject(res);\n    }\n    return res.json();\n  }\n  _getResponseDataWithoutJson(res) {\n    if (!res.ok) {\n      return Promise.reject(res);\n    }\n    return res;\n  }\n  _getHeaders() {\n    const token = localStorage.getItem('jwt');\n    return {\n      'Authorization': `Bearer ${token}`,\n      ...this._headers\n    };\n  }\n\n  // регистрация без подтверждения почты и необходимости аутентификации?\n  register(name, email, password) {\n    return fetch(`${this._url}/sign_up`, {\n      method: 'POST',\n      headers: this._headers,\n      body: JSON.stringify({\n        name,\n        email,\n        password\n      })\n    }).then(this._getResponseData).then(res => {\n      if (res.token) {\n        localStorage.setItem('jwt', res.token);\n        return res;\n      }\n    });\n  }\n  login(email, password) {\n    return fetch(`${this._url}/sign_in`, {\n      method: 'POST',\n      headers: this._getHeaders(),\n      body: JSON.stringify({\n        email,\n        password\n      })\n    }).then(this._getResponseData).then(res => {\n      if (res.token) {\n        localStorage.setItem('jwt', res.token);\n        return res;\n      }\n    });\n  }\n  checkToken(token) {\n    return fetch(`${this._url}/me`, {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json',\n        'Authorization': `Bearer ${token}`\n      }\n    }).then(this._getResponseData);\n  }\n  getUserData() {\n    return fetch(this._url + '/me', {\n      method: 'GET',\n      headers: this._getHeaders()\n    }).then(this._getResponseData);\n  }\n\n  // НЕ РЕАЛИЗОВАНО\n  updateUserData(data) {\n    return fetch(this._url + '/me', {\n      method: 'PATCH',\n      headers: this._getHeaders(),\n      body: JSON.stringify({\n        name: data.name,\n        email: data.email\n        // а как менять пароль?\n      })\n    }).then(this._getResponseData);\n  }\n  saveProduct(productId) {\n    return fetch(this._url + '/me/wishlist', {\n      method: 'POST',\n      headers: this._getHeaders(),\n      body: JSON.stringify({\n        productId: productId\n      })\n    }).then(this._getResponseDataWithoutJson);\n  }\n  removeProduct(productId) {\n    return fetch(this._url + `/me/wishlist?productId=${productId}`, {\n      method: 'DELETE',\n      headers: this._getHeaders()\n    }).then(this._getResponseDataWithoutJson);\n  }\n\n  // получаем массив айдишников продуктов\n  getSavedProducts() {\n    return fetch(this._url + '/me/wishlist', {\n      method: 'GET',\n      headers: this._getHeaders()\n    }).then(this._getResponseData);\n  }\n  getOrders() {\n    return fetch(this._url + '/me/orders', {\n      method: 'GET',\n      headers: this._getHeaders()\n    }).then(this._getResponseData);\n  }\n\n  // getCart() {\n  //   return fetch(this._url + '/me', {\n  //     method: 'GET',\n  //     headers: this._getHeaders(),\n  //   })\n  //   .then(this._getResponseData);\n  // }\n  // получить корзину с сервера чтобы апдейтнуть\n\n  // addToCart(productId) {\n  //   return fetch(this._url + '/me', {\n  //     method: 'PATCH',\n  //     headers: this._getHeaders(),\n  //     body: JSON.stringify({\n  //       cart: productId,\n\n  //     })\n  //   })\n  //     .then(this._getResponseData);\n  // }\n\n  updateCart(data) {\n    return fetch(this._url + '/me', {\n      method: 'PATCH',\n      headers: this._getHeaders(),\n      body: JSON.stringify({\n        cart: data\n      })\n      // localStorage.setItem('cart', JSON.stringify(newCart));\n    }).then(this._getResponseDataWithoutJson);\n  }\n  getUsersProfile() {\n    return Promise.all([this.getSavedProducts(), this.getOrders()]);\n  }\n  addOrder(orderData) {\n    return fetch(this._url + '/me/orders', {\n      method: 'POST',\n      headers: this._getHeaders(),\n      body: JSON.stringify({\n        orderData\n      })\n      // localStorage.setItem('cart', JSON.stringify(newCart));\n    }).then(this._getResponseDataWithoutJson);\n  }\n}\nconst usersApi = new UsersApi({\n  url: ' https://backend.dolina.shop',\n  headers: {\n    'Accept': 'application/json',\n    'Content-Type': 'application/json'\n  }\n});\nexport default usersApi;","map":{"version":3,"names":["UsersApi","constructor","options","_url","url","_headers","headers","_getResponseData","res","ok","Promise","reject","json","_getResponseDataWithoutJson","_getHeaders","token","localStorage","getItem","register","name","email","password","fetch","method","body","JSON","stringify","then","setItem","login","checkToken","getUserData","updateUserData","data","saveProduct","productId","removeProduct","getSavedProducts","getOrders","updateCart","cart","getUsersProfile","all","addOrder","orderData","usersApi"],"sources":["C:/Users/Maria/Desktop/Coding/01dolina/dolina_frontend/src/utils/UsersApi.js"],"sourcesContent":["class UsersApi {\r\n  constructor(options) {\r\n    this._url = options.url\r\n    this._headers = options.headers\r\n  }\r\n\r\n  _getResponseData(res) {\r\n    if (!res.ok) {\r\n      return Promise.reject(res);\r\n    }\r\n    return res.json();\r\n  }\r\n\r\n  _getResponseDataWithoutJson(res) {\r\n    if (!res.ok) {\r\n      return Promise.reject(res);\r\n    }\r\n    return res;\r\n  }\r\n\r\n  _getHeaders() {\r\n    const token = localStorage.getItem('jwt');\r\n\r\n    return {\r\n      'Authorization': `Bearer ${token}`,\r\n      ...this._headers};\r\n  }\r\n\r\n  // регистрация без подтверждения почты и необходимости аутентификации?\r\n  register(name, email, password) {\r\n    return fetch(`${this._url}/sign_up`, {\r\n      method: 'POST',\r\n      headers: this._headers,\r\n      body: JSON.stringify({ name, email, password })\r\n    })\r\n    .then(this._getResponseData)\r\n    .then((res) => {\r\n      if (res.token) {\r\n        localStorage.setItem('jwt', res.token);\r\n        return res;\r\n      }\r\n    })\r\n  }\r\n\r\n  login(email, password) {\r\n    return fetch(`${this._url}/sign_in`, {\r\n      method: 'POST',\r\n      headers: this._getHeaders(),\r\n      body: JSON.stringify({ email, password })\r\n    })\r\n      .then(this._getResponseData)\r\n      .then((res) => {\r\n        if (res.token) {\r\n          localStorage.setItem('jwt', res.token);\r\n          return res;\r\n        }\r\n      })\r\n  }\r\n\r\n  checkToken(token) {\r\n    return fetch(`${this._url}/me`, {\r\n      method: 'GET',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n        'Authorization': `Bearer ${token}`\r\n      }\r\n    })\r\n    .then(this._getResponseData);\r\n  }\r\n\r\n  getUserData() {\r\n    return fetch(this._url + '/me', {\r\n      method: 'GET',\r\n      headers: this._getHeaders()\r\n    })\r\n      .then(this._getResponseData);\r\n  }\r\n\r\n\r\n  // НЕ РЕАЛИЗОВАНО\r\n  updateUserData(data) {\r\n    return fetch(this._url + '/me', {\r\n      method: 'PATCH',\r\n      headers: this._getHeaders(),\r\n      body: JSON.stringify({\r\n        name: data.name,\r\n        email: data.email\r\n        // а как менять пароль?\r\n      })\r\n    })\r\n      .then(this._getResponseData);\r\n  }\r\n\r\n  saveProduct(productId) {\r\n    return fetch(this._url + '/me/wishlist', {\r\n      method: 'POST',\r\n      headers: this._getHeaders(),\r\n      body: JSON.stringify({\r\n        productId: productId\r\n      })\r\n    })\r\n    .then(this._getResponseDataWithoutJson);\r\n  }\r\n\r\n  removeProduct(productId) {\r\n    return fetch(this._url + `/me/wishlist?productId=${productId}`, {\r\n      method: 'DELETE',\r\n      headers: this._getHeaders()\r\n    })\r\n    .then(this._getResponseDataWithoutJson);\r\n  }\r\n\r\n\r\n  // получаем массив айдишников продуктов\r\n  getSavedProducts() {\r\n    return fetch(this._url + '/me/wishlist', {\r\n      method: 'GET',\r\n      headers: this._getHeaders(),\r\n    })\r\n    .then(this._getResponseData);\r\n  }\r\n\r\n  getOrders() {\r\n    return fetch(this._url + '/me/orders', {\r\n      method: 'GET',\r\n      headers: this._getHeaders(),\r\n    })\r\n    .then(this._getResponseData);\r\n  }\r\n\r\n  \r\n\r\n  // getCart() {\r\n  //   return fetch(this._url + '/me', {\r\n  //     method: 'GET',\r\n  //     headers: this._getHeaders(),\r\n  //   })\r\n  //   .then(this._getResponseData);\r\n  // }\r\n  // получить корзину с сервера чтобы апдейтнуть\r\n  \r\n  // addToCart(productId) {\r\n  //   return fetch(this._url + '/me', {\r\n  //     method: 'PATCH',\r\n  //     headers: this._getHeaders(),\r\n  //     body: JSON.stringify({\r\n  //       cart: productId,\r\n\r\n  //     })\r\n  //   })\r\n  //     .then(this._getResponseData);\r\n  // }\r\n\r\n  updateCart(data) {\r\n    return fetch(this._url + '/me', {\r\n      method: 'PATCH',\r\n      headers: this._getHeaders(),\r\n      body: JSON.stringify({\r\n       cart: data \r\n      })\r\n      // localStorage.setItem('cart', JSON.stringify(newCart));\r\n    })\r\n    .then(this._getResponseDataWithoutJson);\r\n  }\r\n\r\n  getUsersProfile() {\r\n    return Promise.all([this.getSavedProducts(), this.getOrders()]);\r\n  }\r\n\r\n  addOrder(orderData) {\r\n    return fetch(this._url + '/me/orders', {\r\n      method: 'POST',\r\n      headers: this._getHeaders(),\r\n      body: JSON.stringify({orderData})\r\n      // localStorage.setItem('cart', JSON.stringify(newCart));\r\n    })\r\n    .then(this._getResponseDataWithoutJson);\r\n  }\r\n\r\n}\r\n\r\n\r\n\r\n\r\nconst usersApi = new UsersApi({\r\n  url: ' https://backend.dolina.shop',\r\n  headers: {\r\n    'Accept': 'application/json',\r\n    'Content-Type': 'application/json'\r\n  }\r\n})\r\n\r\nexport default usersApi;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}