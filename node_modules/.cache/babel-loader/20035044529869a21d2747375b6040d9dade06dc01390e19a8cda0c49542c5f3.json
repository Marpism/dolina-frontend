{"ast":null,"code":"class UsersApi{constructor(options){this._url=options.url;this._headers=options.headers;}_getResponseData(res){if(!res.ok){return Promise.reject(res);}return res.json();}_getResponseDataWithoutJson(res){if(!res.ok){return Promise.reject(res);}return res;}_getHeaders(){const token=localStorage.getItem('jwt');return{'Authorization':\"Bearer \".concat(token),...this._headers};}// регистрация без подтверждения почты и необходимости аутентификации?\nregister(name,email,password){return fetch(\"\".concat(this._url,\"/sign_up\"),{method:'POST',headers:this._headers,body:JSON.stringify({name,email,password})}).then(this._getResponseData).then(res=>{if(res.token){localStorage.setItem('jwt',res.token);return res;}});}login(email,password){return fetch(\"\".concat(this._url,\"/sign_in\"),{method:'POST',headers:this._getHeaders(),body:JSON.stringify({email,password})}).then(this._getResponseData).then(res=>{if(res.token){localStorage.setItem('jwt',res.token);return res;}});}yandexOauth(name,email,phone,yandexOauth,yandexUserId){return fetch(\"\".concat(this._url,\"/yandex_oauth\"),{method:'POST',headers:this._headers,body:JSON.stringify({name,email,phone,yandexOauth,yandexUserId})}).then(this._getResponseData).then(res=>{if(res.token){localStorage.setItem('jwt',res.token);return res;}});}requestPasswordReset(email){return fetch(\"\".concat(this._url,\"/request_password_reset\"),{method:'POST',headers:this._getHeaders(),body:JSON.stringify({email})}).then(this._getResponseDataWithoutJson);}reset_password(token,password){return fetch(\"\".concat(this._url,\"/reset_password\"),{method:'POST',headers:this._getHeaders(),body:JSON.stringify({token,password})}).then(this._getResponseDataWithoutJson);}checkToken(token){return fetch(\"\".concat(this._url,\"/me\"),{method:'GET',headers:{'Content-Type':'application/json','Authorization':\"Bearer \".concat(token)}}).then(this._getResponseData);}getUserData(){return fetch(this._url+'/me',{method:'GET',headers:this._getHeaders()}).then(this._getResponseData);}updateUserData(data){return fetch(this._url+'/me',{method:'PATCH',headers:this._getHeaders(),body:JSON.stringify({name:data.name,email:data.email// а как менять пароль?\n})}).then(this._getResponseData);}saveProduct(productId){return fetch(this._url+'/me/wishlist',{method:'POST',headers:this._getHeaders(),body:JSON.stringify({productId:productId})}).then(this._getResponseDataWithoutJson);}removeProduct(productId){return fetch(this._url+\"/me/wishlist?productId=\".concat(productId),{method:'DELETE',headers:this._getHeaders()}).then(this._getResponseDataWithoutJson);}// получаем массив айдишников продуктов\ngetSavedProducts(){return fetch(this._url+'/me/wishlist',{method:'GET',headers:this._getHeaders()}).then(this._getResponseData);}getOrders(){return fetch(this._url+'/me/orders',{method:'GET',headers:this._getHeaders()}).then(this._getResponseData);}// getCart() {\n//   return fetch(this._url + '/me', {\n//     method: 'GET',\n//     headers: this._getHeaders(),\n//   })\n//   .then(this._getResponseData);\n// }\n// получить корзину с сервера чтобы апдейтнуть\n// addToCart(productId) {\n//   return fetch(this._url + '/me', {\n//     method: 'PATCH',\n//     headers: this._getHeaders(),\n//     body: JSON.stringify({\n//       cart: productId,\n//     })\n//   })\n//     .then(this._getResponseData);\n// }\nupdateCart(data){return fetch(this._url+'/me',{method:'PATCH',headers:this._getHeaders(),body:JSON.stringify({cart:data})// localStorage.setItem('cart', JSON.stringify(newCart));\n}).then(this._getResponseDataWithoutJson);}addOrder(orderData){return fetch(this._url+'/me/orders',{method:'POST',headers:this._getHeaders(),body:JSON.stringify(orderData)// localStorage.setItem('cart', JSON.stringify(newCart));\n}).then(this._getResponseData);}orderSuccess(orderId){return fetch(this._url+'/me/orders/success?orderId='+orderId,{method:'GET',headers:this._getHeaders()}).then(this._getResponseData);}// orderPayment(orderId, paymentUrl) {\n//   return fetch(this._url + '/me/orders/payment?orderId=' + orderId + '&paymentUrl=' + paymentUrl, {\n//     method: 'GET',\n//     headers: this._getHeaders(),\n//   })\n//   .then(this._getResponseData);\n// }\norderPay(orderId){return fetch(this._url+'/me/orders/pay?orderId='+orderId,{method:'GET',headers:this._getHeaders()}).then(this._getResponseData);}getUsersProfile(){return Promise.all([this.getSavedProducts(),this.getOrders(),this.getUserData()]);}}const usersApi=new UsersApi({url:process.env.REACT_APP_BACKEND_URL,headers:{'Accept':'application/json','Content-Type':'application/json'}});export default usersApi;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}