{"ast":null,"code":"import'./Tags.css';import{useEffect,useState}from'react';import SearchForm from'../SearchForm/SearchForm';import caret from'../../images/caret-down_mini.svg';import{NavLink}from'react-router-dom';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Tags(_ref){let{terms,tags,categories,onTagClick,onColorClick,activeCategory,activeTags,sortBy,setSortBy,sortOrder,setSortOrder,productFilters,setProductFilters}=_ref;const[selectedTags,setSelectedTags]=useState([]);const[filteredTags,setFilteredTags]=useState([]);const[selectedColors,setSelectedColors]=useState([]);const[openDropdownIndex,setOpenDropdownIndex]=useState(null);const[stonesInputValue,setStonesInputValue]=useState('');const handleTagToggle=tag=>{let activeTagsTemporary=[];if(selectedTags.includes(tag)){activeTagsTemporary=selectedTags.filter(selectedTag=>selectedTag!==tag);}else{activeTagsTemporary=[...selectedTags,tag];}setSelectedTags(activeTagsTemporary);onTagClick(activeTagsTemporary);};const handleColorToggle=color=>{let activeColorsTemporary=[];if(selectedColors.includes(color)){activeColorsTemporary=selectedColors.filter(selectedColor=>selectedColor!==color);}else{activeColorsTemporary=[...selectedColors,color];}setSelectedColors(activeColorsTemporary);onColorClick(activeColorsTemporary);};const toggleDropdown=(index,event)=>{event.stopPropagation();// Останавливаем распространение события клика\nsetOpenDropdownIndex(prevIndex=>prevIndex===index?null:index);// Открываем или закрываем текущий выпадающий список\n};useEffect(()=>{if(tags){setFilteredTags(tags.filter(tag=>tag.count!==0));if(productFilters.category>0){const activeCategoryTags=JSON.parse(categories.filter(item=>item.termId==productFilters.category)[0].category_tags);setFilteredTags(tags.filter(tag=>activeCategoryTags.includes(Number(tag.termId))));}if(stonesInputValue.length>0){setFilteredTags(filteredTags.filter(tag=>tag.name.toLowerCase().includes(stonesInputValue.toLowerCase())));}else{}}},[tags,productFilters,stonesInputValue]);useEffect(()=>{setSelectedTags([]);setSelectedColors([]);},[productFilters.category]);useEffect(()=>{setSelectedColors(productFilters.colors);},[]);useEffect(()=>{setSelectedTags(productFilters.tags);},[]);// useEffect(() => {\n// }, [filteredTags]);\nuseEffect(()=>{// Function to handle click events\nconst handleClick=event=>{const target=event.target;const parent=target.parentElement;// Check if the click target or its parent has the class 'tags__dropdown'\nif(!target.classList.contains('dropdown_selector')&&!(parent&&parent.classList.contains('dropdown_selector'))){setOpenDropdownIndex(null);// Закрываем выпадающий список\n}};// Add event listener to the document\ndocument.addEventListener('click',handleClick);// Cleanup event listener on component unmount\nreturn()=>{document.removeEventListener('click',handleClick);};},[]);function handleStonesInput(input){const inputValue=input.target.value;setStonesInputValue(inputValue);}const handleSortChange=value=>{setProductFilters(prevFilters=>({...prevFilters,sortBy:value,offset:0}));};const sortOptions=[{value:'default',label:'По умолчанию'},{value:'price-asc',label:'По возрастанию цены'},{value:'price-desc',label:'По убыванию цены '},{value:'date-desc',label:'По новизне'},{value:'discount-desc',label:'По размеру скидки'}];return/*#__PURE__*/_jsxs(\"section\",{className:\"tag-section\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"sorting-area\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"sorting-dropdown\",children:[/*#__PURE__*/_jsxs(\"button\",{type:\"button\",className:\"sorting-dropdown__button pointer\",onClick:event=>toggleDropdown(0,event),children:[\"\\u0421\\u043E\\u0440\\u0442\\u0438\\u0440\\u043E\\u0432\\u043A\\u0430  \",/*#__PURE__*/_jsx(\"img\",{src:caret,alt:\"caret\",style:{marginLeft:'5px'}})]}),/*#__PURE__*/_jsx(\"div\",{className:\"sorting-content overflow-hidden \".concat(openDropdownIndex===0?'sorting-content_visible':''),children:/*#__PURE__*/_jsx(\"div\",{className:\"tags__dropdown sorting_by\",children:sortOptions.map(option=>/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleSortChange(option.value),style:{fontWeight:productFilters.sortBy===option.value?'bold':'normal'},children:option.label},option.value))})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"sorting-dropdown\",children:[/*#__PURE__*/_jsxs(\"button\",{type:\"button\",className:\"sorting-dropdown__button pointer\",onClick:event=>toggleDropdown(5,event),children:[\"\\u041A\\u0430\\u043C\\u043D\\u0438  \",/*#__PURE__*/_jsx(\"img\",{src:caret,alt:\"caret\",style:{marginLeft:'5px'}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"sorting-content dropdown_selector \".concat(openDropdownIndex===5?'sorting-content_visible':''),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"tags__dropdown dropdown_selector\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"dropdown_selector\",children:/*#__PURE__*/_jsx(\"input\",{className:\"stone-search\",type:\"text\",onChange:handleStonesInput,placeholder:\"\\u043D\\u0430\\u0447\\u043D\\u0438\\u0442\\u0435 \\u0432\\u0432\\u043E\\u0434\\u0438\\u0442\\u044C \\u043D\\u0430\\u0437\\u0432\\u0430\\u043D\\u0438\\u0435\"})}),tags&&filteredTags.map(tag=>/*#__PURE__*/_jsxs(\"label\",{className:\"tag-label\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",value:tag.termId,className:\"tag-button_dropdown\",checked:selectedTags&&selectedTags.some(selectedTag=>selectedTag===tag.termId)?'checked':'',onChange:event=>{event.stopPropagation();// Остановка распространения события клика\nhandleTagToggle(tag.termId);}}),/*#__PURE__*/_jsxs(\"div\",{className:\"tag-pseudo-checkbox pointer\",onClick:event=>event.stopPropagation(),children:[tag.name,!productFilters.category&&/*#__PURE__*/_jsx(\"span\",{className:\"tag-count\",children:tag.count}),\" \"]})]},tag.termId))]}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"sorting-button\",onClick:()=>setOpenDropdownIndex(null),children:\"\\u0413\\u043E\\u0442\\u043E\\u0432\\u043E\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"sorting-dropdown\",children:[/*#__PURE__*/_jsxs(\"button\",{type:\"button\",className:\"sorting-dropdown__button pointer\",onClick:event=>toggleDropdown(9,event),children:[\"\\u0426\\u0432\\u0435\\u0442\\u0430  \",/*#__PURE__*/_jsx(\"img\",{src:caret,alt:\"caret\",style:{marginLeft:'5px'}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"sorting-content dropdown_selector \".concat(openDropdownIndex===9?'sorting-content_visible':''),children:[/*#__PURE__*/_jsx(\"div\",{className:\"tags__dropdown dropdown_selector\",children:terms&&terms.colors&&terms.colors.map(color=>/*#__PURE__*/_jsxs(\"label\",{className:\"tag-label\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",value:color.termId,className:\"tag-button_dropdown\",checked:selectedColors&&selectedColors.some(selectedColor=>selectedColor===color.termId)?'checked':'',onChange:event=>{event.stopPropagation();// Остановка распространения события клика\nhandleColorToggle(color.termId);}}),/*#__PURE__*/_jsxs(\"div\",{className:\"tag-pseudo-checkbox pointer\",onClick:event=>event.stopPropagation(),children:[color.name,/*#__PURE__*/_jsx(\"span\",{className:\"color_ball\",style:{background:color.extra}})]})]},color.termId))}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"sorting-button\",onClick:()=>setOpenDropdownIndex(null),children:\"\\u0413\\u043E\\u0442\\u043E\\u0432\\u043E\"})]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"tag-area\",children:tags&&filteredTags.slice(0,8).map(tag=>/*#__PURE__*/_jsxs(\"label\",{className:\"tag-label\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",value:tag.termId,className:\"tag-button\",checked:selectedTags&&selectedTags.some(selectedTag=>selectedTag===tag.termId)?'checked':'',onChange:()=>handleTagToggle(tag.termId)}),/*#__PURE__*/_jsxs(\"div\",{className:\"tag-pseudo-button pointer\",children:[tag.name,!productFilters.category&&/*#__PURE__*/_jsx(\"span\",{className:\"tag-count\",children:tag.count}),\" \"]})]},tag.termId))})]});};{/* {tags && filteredTags.map(tag => (\r\n               <label key={tag.termId} className='tag-label'>\r\n                <input\r\n                  type=\"checkbox\"\r\n                  value={tag.termId}\r\n                  className='tag-button'\r\n                  checked={selectedTags && selectedTags.some(selectedTag => selectedTag === tag.termId) ? 'checked' : ''}\r\n                  onChange={() => handleTagToggle(tag.termId)}\r\n                />\r\n                <div className='tag-pseudo-button pointer'>{tag.name}{!activeCategory && (<span className=\"tag-count\">{tag.count}</span>)} </div>\r\n                выше этот восклицательный потому что у категорий нет отдельного подсчёта пока\r\n              </label>\r\n            ))} */}","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}