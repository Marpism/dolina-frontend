{"ast":null,"code":"// import './Tags.css';\n// import { useEffect, useState } from 'react';\n// // import SearchForm from '../SearchForm/SearchForm';\n// import caret from '../../images/caret-down_mini.svg';\n// import sorting from '../../images/sorting_2.svg';\n// // import { NavLink } from 'react-router-dom';\n// import { useMediaQuery } from 'react-responsive';\n// import { NavLink, useLocation } from 'react-router-dom';\n// export default function Tags({ terms, tags, categories, onTagClick, onColorClick, onSizeClick, activeCategory, activeTags, sortBy, setSortBy, sortOrder, setSortOrder, productFilters, setProductFilters, onCatClick }) {\n//   const [selectedTags, setSelectedTags] = useState([]);\n//   const [filteredTags, setFilteredTags] = useState([]);\n//   const [selectedColors, setSelectedColors] = useState([]);\n//   const [selectedSizes, setSelectedSizes] = useState([]);\n//   const [openDropdownIndex, setOpenDropdownIndex] = useState(null);\n//   const [stonesInputValue, setStonesInputValue] = useState('');\n//   const [selectedCategoryName, setSelectedCategoryName] = useState('');\n//   const isBigScreen = useMediaQuery({ minWidth: 771 }); // надо бы перенести в константы\n//   const isSmallScreen = useMediaQuery({ maxWidth: 770 });\n//   const location = useLocation();\n//   // console.log(tags);\n//   const handleTagToggle = (tag) => {\n//     let activeTagsTemporary = [];\n//     if (selectedTags.includes(tag)) {\n//       activeTagsTemporary = selectedTags.filter(selectedTag => selectedTag !== tag)\n//     } else {\n//       activeTagsTemporary = [...selectedTags, tag];\n//     }\n//     setSelectedTags(activeTagsTemporary);\n//     onTagClick(activeTagsTemporary);\n//   };\n//   // console.log(terms)\n//   function handleCategoryClick(event) {\n//     event.preventDefault();\n//     const selectedCategoryId = event.target.dataset.id;\n//     onCatClick(selectedCategoryId);\n//     setOpenDropdownIndex(null)\n//   }\n//   const handleColorToggle = (color) => {\n//     let activeColorsTemporary = [];\n//     if (selectedColors.includes(color)) {\n//       activeColorsTemporary = selectedColors.filter(selectedColor => selectedColor !== color)\n//     } else {\n//       activeColorsTemporary = [...selectedColors, color];\n//     }\n//     setSelectedColors(activeColorsTemporary);\n//     onColorClick(activeColorsTemporary);\n//   };\n//     const handleSizeToggle = (size) => {\n//     let activeSizesTemporary = [];\n//     if (selectedSizes.includes(size)) {\n//       activeSizesTemporary = selectedSizes.filter(selectedSize => selectedSize !== size)\n//     } else {\n//       activeSizesTemporary = [...selectedSizes, size];\n//     }\n//     setSelectedSizes(activeSizesTemporary);\n//     onSizeClick(activeSizesTemporary);\n//   };\n//   const toggleDropdown = (index, event) => {\n//     event.stopPropagation(); // Останавливаем распространение события клика\n//     setOpenDropdownIndex(prevIndex => (prevIndex === index ? null : index)); // Открываем или закрываем текущий выпадающий список\n//   };\n//   useEffect(() => {\n//     if (tags) {\n//       setFilteredTags(tags.filter(tag => tag.count !== 0));\n//       if (productFilters.category > 0) {\n//         const activeCategoryTags = JSON.parse(categories.filter(item => item.termId == productFilters.category)[0].category_tags);\n//         setFilteredTags(tags.filter(tag => activeCategoryTags.includes(Number(tag.termId))));\n//       }\n//       if (stonesInputValue.length > 0) {\n//         setFilteredTags(filteredTags.filter(tag => tag.name.toLowerCase().includes(stonesInputValue.toLowerCase())))\n//       } else {\n//       }\n//     }\n//   }, [tags, productFilters, stonesInputValue]);\n//   useEffect(() => {\n//     if (productFilters.tags.length === 0) setSelectedTags([]);\n//     if (productFilters.colors.length === 0) setSelectedColors([]);\n//     if (productFilters.sizes.length === 0) setSelectedSizes([]);\n//   }, [productFilters]);\n//   // useEffect(() => {\n//   //   setSelectedColors(productFilters.colors);\n//   // }, []);\n//   // useEffect(() => {\n//   //   setSelectedSizes(productFilters.sizes);\n//   // }, []);\n//   // useEffect(() => {\n//   //   setSelectedTags(productFilters.tags);\n//   // }, []);\n//   useEffect(() => {\n//     setSelectedCategoryName('');\n//   }, [productFilters]);\n//   // useEffect(() => {\n//   // }, [filteredTags]);\n//   useEffect(() => {\n//     // Function to handle click events\n//     const handleClick = (event) => {\n//       const target = event.target;\n//       const parent = target.parentElement;\n//       if (!target.classList.contains('dropdown_selector') && !(parent && parent.classList.contains('dropdown_selector'))) {\n//         setOpenDropdownIndex(null); // Закрываем выпадающий список\n//       }\n//     };\n//     // Add event listener to the document\n//     document.addEventListener('click', handleClick);\n//     // Cleanup event listener on component unmount\n//     return () => {\n//       document.removeEventListener('click', handleClick);\n//     };\n//   }, []);\n//   // useEffect(() => {\n//   //   // Извлекаем categoryId из URL\n//   //   const query = new URLSearchParams(location.search);\n//   //   const categoryId = query.get('category');\n//   //   if (categoryId) {\n//   //     const category = terms.categories.find(cat => cat.termId === parseInt(categoryId));\n//   //     if (category) {\n//   //       setSelectedCategoryName(category.name);\n//   //     }\n//   //   }\n//   // }, [location.search, terms.categories]);\n//   useEffect(() => {\n//     // Извлекаем categoryId из URL\n//     const query = new URLSearchParams(location.search);\n//     const categoryId = query.get('category');\n//     if (categoryId && terms.categories) {\n//       const category = terms.categories.find(cat => cat.termId === parseInt(categoryId));\n//       if (category) {\n//         setSelectedCategoryName(category.name);\n//       }\n//     }\n//   }, [location.search, terms.categories]);\n//   function handleStonesInput(input) {\n//     const inputValue = input.target.value;\n//     setStonesInputValue(inputValue);\n//   }\n//   const handleSortChange = (value) => {\n//     setProductFilters(prevFilters => ({\n//       ...prevFilters,\n//       sortBy: value,\n//       offset: 0\n//     }));\n//   };\n//   const handleMasterpieceChange = (event) => {\n//     setProductFilters(prevFilters => ({\n//       ...prevFilters,\n//       masterpiece: event.target.checked ? 1 : ''\n//     }));\n//   };\n//   const handleIridescentChange = (event) => {\n//     setProductFilters(prevFilters => ({\n//       ...prevFilters,\n//       iridescent: event.target.checked ? 1 : ''\n//     }));\n//   };\n//   const sortOptions = [\n//     { value: 'default', label: 'По умолчанию' },\n//     { value: 'price-asc', label: 'По возрастанию цены' },\n//     { value: 'price-desc', label: 'По убыванию цены' },\n//     { value: 'date-desc', label: 'По новизне' },\n//     { value: 'discount-desc', label: 'По размеру скидки' }\n//   ];\n//   return (\n//     <section className='tag-section'>\n//       {isBigScreen &&\n//         <>\n//           <div className='sorting-area'>\n//               <div className='sorting-dropdown'>\n//               {/* <button type='button' className='sorting-dropdown__button pointer' onClick={(event) => toggleDropdown(0, event)}>Сортировка  <img src={sorting} alt=\"caret\" style={{ marginLeft: '5px' }} /></button> */}\n//               <button type='button' className='sorting__button pointer' onClick={(event) => toggleDropdown(0, event)}><img src={sorting} alt=\"sort\" /></button>\n//               <div className={`sorting-content overflow-hidden ${openDropdownIndex === 0 ? 'sorting-content_visible' : ''}`}>\n//                 <div className=\"tags__dropdown sorting_by\">\n//                   {sortOptions.map(option => (\n//                     <button\n//                       key={option.value}\n//                       onClick={() => handleSortChange(option.value)}\n//                       style={{ fontWeight: productFilters.sortBy === option.value ? 'bold' : 'normal' }}\n//                     >\n//                       {option.label}\n//                     </button>\n//                   ))}\n//                 </div>\n//               </div>\n//             </div>\n//              <div className='sorting-dropdown'>\n//               <button type='button' className='sorting-dropdown__button pointer' onClick={(event) => toggleDropdown(8, event)}>{selectedSizes.length > 0 ?`Размеры (${selectedSizes.length}) ` : 'Размеры'} <img src={caret} alt=\"caret\" style={{ marginLeft: '5px' }} /></button>\n//               <div className={`sorting-content dropdown_selector ${openDropdownIndex === 8 ? 'sorting-content_visible' : ''}`}>\n//                 <div className=\"tags__dropdown dropdown_selector\">\n//                   {/* <SearchForm /> */}\n//                   {terms && terms.sizes && terms.sizes.map(size => (\n//                     <label key={size.termId} className='tag-label'>\n//                       <input\n//                         type=\"checkbox\"\n//                         value={size.termId}\n//                         className='tag-button_dropdown'\n//                         checked={selectedSizes && selectedSizes.some(selectedSize => selectedSize === size.termId) ? 'checked' : ''}\n//                         onChange={(event) => {\n//                           event.stopPropagation(); // Остановка распространения события клика\n//                           handleSizeToggle(size.termId);\n//                         }}\n//                       />\n//                       <div className='tag-pseudo-checkbox pointer' onClick={(event) => event.stopPropagation()}>{size.name}</div>\n//                     </label>\n//                   ))}\n//                   {/* <button type='button' className='sorting-button'>Готово</button> */}\n//                 </div>\n//                 <button type='button' className='sorting-button' onClick={() => setOpenDropdownIndex(null)}>Готово</button>\n//               </div>\n//             </div>\n//             <div className='sorting-dropdown'>\n//               <button type='button' className='sorting-dropdown__button pointer' onClick={(event) => toggleDropdown(5, event)}>Все камни  <img src={caret} alt=\"caret\" style={{ marginLeft: '5px' }} /></button>\n//               <div className={`sorting-content dropdown_selector ${openDropdownIndex === 5 ? 'sorting-content_visible' : ''}`}>\n//                 <div className=\"tags__dropdown dropdown_selector\">\n//                   <div className='dropdown_selector'>\n//                     <input className='stone-search' type='text' onChange={handleStonesInput} placeholder='начните вводить название'></input>\n//                   </div>\n//                   {tags && filteredTags.map(tag => (\n//                     <label key={tag.termId} className='tag-label'>\n//                       <input\n//                         type=\"checkbox\"\n//                         value={tag.termId}\n//                         className='tag-button_dropdown'\n//                         checked={selectedTags && selectedTags.some(selectedTag => selectedTag === tag.termId) ? 'checked' : ''}\n//                         onChange={(event) => {\n//                           event.stopPropagation(); // Остановка распространения события клика\n//                           handleTagToggle(tag.termId);\n//                         }}\n//                       />\n//                       <div className='tag-pseudo-checkbox pointer' onClick={(event) => event.stopPropagation()}>{tag.name}{!productFilters.category && (<span className=\"tag-count\">{tag.count}</span>)} </div>\n//                     </label>\n//                   ))}\n//                   {/* <button type='button' className='sorting-button'>Готово</button> */}\n//                 </div>\n//                 <button type='button' className='sorting-button' onClick={() => setOpenDropdownIndex(null)}>Готово</button>\n//               </div>\n//             </div>\n//             <div className='sorting-dropdown'>\n//               <button type='button' className='sorting-dropdown__button pointer' onClick={(event) => toggleDropdown(9, event)}>{selectedColors.length > 0 ?`Цвета (${selectedColors.length}) ` : 'Цвета'} <img src={caret} alt=\"caret\" style={{ marginLeft: '5px' }} /></button>\n//               <div className={`sorting-content dropdown_selector ${openDropdownIndex === 9 ? 'sorting-content_visible' : ''}`}>\n//                 <div className=\"tags__dropdown dropdown_selector\">\n//                   {/* <SearchForm /> */}\n//                   {terms && terms.colors && terms.colors.map(color => (\n//                     <label key={color.termId} className='tag-label'>\n//                       <input\n//                         type=\"checkbox\"\n//                         value={color.termId}\n//                         className='tag-button_dropdown'\n//                         checked={selectedColors && selectedColors.some(selectedColor => selectedColor === color.termId) ? 'checked' : ''}\n//                         onChange={(event) => {\n//                           event.stopPropagation(); // Остановка распространения события клика\n//                           handleColorToggle(color.termId);\n//                         }}\n//                       />\n//                       <div className='tag-pseudo-checkbox pointer' onClick={(event) => event.stopPropagation()}>{color.name}<span className='color_ball' style={{ background: color.extra }}></span></div>\n//                     </label>\n//                   ))}\n//                   {/* <button type='button' className='sorting-button'>Готово</button> */}\n//                 </div>\n//                 <button type='button' className='sorting-button' onClick={() => setOpenDropdownIndex(null)}>Готово</button>\n//               </div>\n//             </div>\n//             <label className='tag-label'>\n//               <input\n//                 className='tag-button'\n//                 type=\"checkbox\"\n//                 checked={productFilters.masterpiece}\n//                 onChange={handleMasterpieceChange}\n//               />\n//               <div className='sorting-dropdown__button pointer'>Авторские украшения</div>\n//             </label>\n//             <label className='tag-label'>\n//               <input\n//                 className='tag-button'\n//                 type=\"checkbox\"\n//                 checked={productFilters.iridescent}\n//                 onChange={handleIridescentChange}\n//               />\n//               <div className='sorting-dropdown__button pointer'>Оптический эффект</div>\n//             </label>\n//           </div>\n//           <div className='tag-area'>\n//             {tags && filteredTags.slice(0, 15).map(tag => (\n//               <label key={tag.termId} className='tag-label'>\n//                 <input\n//                   type=\"checkbox\"\n//                   value={tag.termId}\n//                   className='tag-button'\n//                   checked={selectedTags && selectedTags.some(selectedTag => selectedTag === tag.termId) ? 'checked' : ''}\n//                   onChange={() => handleTagToggle(tag.termId)}\n//                 />\n//                 <div className='tag-pseudo-button pointer'>{tag.name}{!productFilters.category && (<span className=\"tag-count\">{tag.count}</span>)} </div>\n//               </label>\n//             ))}\n//           </div>\n//         </>\n//       }\n//       {isSmallScreen &&\n//         <>\n//           <div className='sorting-area'>\n//             <div className='tags_flex'>\n//             <div className='sorting-dropdown'>\n//               {/* <button type='button' className='sorting-dropdown__button pointer' onClick={(event) => toggleDropdown(0, event)}>Сортировка  <img src={sorting} alt=\"caret\" style={{ marginLeft: '5px' }} /></button> */}\n//               <button type='button' className='sorting__button pointer' onClick={(event) => toggleDropdown(0, event)}><img src={sorting} alt=\"sort\" /></button>\n//               <div className={`sorting-content overflow-hidden ${openDropdownIndex === 0 ? 'sorting-content_visible' : ''}`}>\n//                 <div className=\"tags__dropdown sorting_by\">\n//                   {sortOptions.map(option => (\n//                     <button\n//                       key={option.value}\n//                       onClick={() => handleSortChange(option.value)}\n//                       style={{ fontWeight: productFilters.sortBy === option.value ? 'bold' : 'normal' }}\n//                     >\n//                       {option.label}\n//                     </button>\n//                   ))}\n//                 </div>\n//               </div>\n//             </div>\n//             <div className='sorting-dropdown'>\n//               <button type='button' className='sorting-dropdown__button pointer' onClick={(event) => toggleDropdown(12, event)}>Категории <img src={caret} alt=\"caret\" style={{ marginLeft: '5px' }} /></button>\n//               <div className={`sorting-content dropdown_selector ${openDropdownIndex === 12 ? 'sorting-content_visible' : ''}`}>\n//                 <div className=\"tags__dropdown dropdown_selector\">\n//                   {categories && categories.map(category => (\n//                     <NavLink to='' className='tag-pseudo-checkbox' onClick={handleCategoryClick} key={category.termId} data-id={category.termId} style={{ marginBottom: '5px' }}>{category.name}</NavLink>\n//                   ))}\n//                 </div>\n//               </div>\n//             </div>\n//               <div className='sorting-dropdown'>\n//               <button type='button' className='sorting-dropdown__button pointer' onClick={(event) => toggleDropdown(8, event)}>{selectedSizes.length > 0 ?`Размеры (${selectedSizes.length}) ` : 'Размеры'} <img src={caret} alt=\"caret\" style={{ marginLeft: '5px' }} /></button>\n//               <div className={`sorting-content dropdown_selector ${openDropdownIndex === 8 ? 'sorting-content_visible' : ''}`}>\n//                 <div className=\"tags__dropdown dropdown_selector\">\n//                   {/* <SearchForm /> */}\n//                   {terms && terms.sizes && terms.sizes.map(size => (\n//                     <label key={size.termId} className='tag-label'>\n//                       <input\n//                         type=\"checkbox\"\n//                         value={size.termId}\n//                         className='tag-button_dropdown'\n//                         checked={selectedSizes && selectedSizes.some(selectedSize => selectedSize === size.termId) ? 'checked' : ''}\n//                         onChange={(event) => {\n//                           event.stopPropagation(); // Остановка распространения события клика\n//                           handleSizeToggle(size.termId);\n//                         }}\n//                       />\n//                       <div className='tag-pseudo-checkbox pointer' onClick={(event) => event.stopPropagation()}>{size.name}</div>\n//                     </label>\n//                   ))}\n//                   {/* <button type='button' className='sorting-button'>Готово</button> */}\n//                 </div>\n//                 <button type='button' className='sorting-button' onClick={() => setOpenDropdownIndex(null)}>Готово</button>\n//               </div>\n//             </div>\n//             </div>\n//             <div className='tags_flex'>\n//             <label className='tag-label'>\n//               <input\n//                 className='tag-button'\n//                 type=\"checkbox\"\n//                 checked={productFilters.masterpiece}\n//                 onChange={handleMasterpieceChange}\n//               />\n//               <div className='sorting-dropdown__button pointer'>Авторское украшение</div>\n//             </label>\n//             <label className='tag-label'>\n//               <input\n//                 className='tag-button'\n//                 type=\"checkbox\"\n//                 checked={productFilters.iridescent}\n//                 onChange={handleIridescentChange}\n//               />\n//               <div className='sorting-dropdown__button pointer'>Оптический эффект</div>\n//             </label>\n//             </div>\n//           </div>\n//           <div className='tag-area_mobile'>\n//             <div className='sorting-dropdown'>\n//               <button type='button' className='tag-pseudo-button pointer' onClick={(event) => toggleDropdown(9, event)}>\n//                 {selectedColors.length > 0 ?`Цвет (${selectedColors.length}) ` : 'Цвет'}<img src={caret} alt=\"caret\" style={{ marginLeft: '5px' }} /></button>\n//               <div className={`sorting-content dropdown_selector ${openDropdownIndex === 9 ? 'sorting-content_visible' : ''}`}>\n//                 <div className=\"tags__dropdown dropdown_selector\">\n//                   {terms && terms.colors && terms.colors.map(color => (\n//                     <label key={color.termId} className='tag-label'>\n//                       <input\n//                         type=\"checkbox\"\n//                         value={color.termId}\n//                         className='tag-button_dropdown'\n//                         checked={selectedColors && selectedColors.some(selectedColor => selectedColor === color.termId) ? 'checked' : ''}\n//                         onChange={(event) => {\n//                           event.stopPropagation(); // Остановка распространения события клика\n//                           handleColorToggle(color.termId);\n//                         }}\n//                       />\n//                       <div className='tag-pseudo-checkbox pointer' onClick={(event) => event.stopPropagation()}>{color.name}<span className='color_ball' style={{ background: color.extra }}></span></div>\n//                     </label>\n//                   ))}\n//                 </div>\n//                 <button type='button' className='sorting-button' onClick={() => setOpenDropdownIndex(null)}>Готово</button>\n//               </div>\n//             </div>\n//             {tags && filteredTags.map(tag => (\n//               <label key={tag.termId} className='tag-label'>\n//                 <input\n//                   type=\"checkbox\"\n//                   value={tag.termId}\n//                   className='tag-button'\n//                   checked={selectedTags && selectedTags.some(selectedTag => selectedTag === tag.termId) ? 'checked' : ''}\n//                   onChange={() => handleTagToggle(tag.termId)}\n//                 />\n//                 <div className='tag-pseudo-button pointer'>{tag.name}{!productFilters.category && (<span className=\"tag-count\">{tag.count}</span>)} </div>\n//               </label>\n//             ))}\n//           </div>\n//         </>\n//       }\n//       <div className='chosen-area'>\n//         {selectedCategoryName && <h1 className='category-header'>&bull; {selectedCategoryName.toUpperCase()} &bull;</h1>}\n//       </div>\n//     </section>\n//   );\n// };\nimport'./Tags.css';import{useEffect,useMemo,useState}from'react';import caret from'../../images/caret-down_mini.svg';import sorting from'../../images/sorting_2.svg';import{useMediaQuery}from'react-responsive';import{NavLink,useLocation}from'react-router-dom';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export default function Tags(_ref){var _terms$colors,_terms$colors2;let{terms,tags,categories,onTagClick,onColorClick,onSizeClick,activeCategory,activeTags,sortBy,setSortBy,sortOrder,setSortOrder,productFilters,setProductFilters,onCatClick}=_ref;const[selectedTags,setSelectedTags]=useState([]);const[filteredTags,setFilteredTags]=useState([]);const[selectedColors,setSelectedColors]=useState([]);const[selectedSizes,setSelectedSizes]=useState([]);const[openDropdownIndex,setOpenDropdownIndex]=useState(null);const[stonesInputValue,setStonesInputValue]=useState('');const[selectedCategoryName,setSelectedCategoryName]=useState('');const isBigScreen=useMediaQuery({minWidth:771});const isSmallScreen=useMediaQuery({maxWidth:770});const location=useLocation();// --- Ищем категорию «Кольца» и считаем флаг isRings\nconst ringsCategoryId=useMemo(()=>{var _found$termId;const list=(terms===null||terms===void 0?void 0:terms.categories)||categories||[];const found=list.find(c=>{var _c$name,_c$name$trim,_c$slug,_c$slug$toLowerCase,_c$slug2,_c$slug2$toLowerCase;return(c===null||c===void 0?void 0:(_c$name=c.name)===null||_c$name===void 0?void 0:(_c$name$trim=_c$name.trim())===null||_c$name$trim===void 0?void 0:_c$name$trim.toLowerCase())==='кольца'||(c===null||c===void 0?void 0:(_c$slug=c.slug)===null||_c$slug===void 0?void 0:(_c$slug$toLowerCase=_c$slug.toLowerCase)===null||_c$slug$toLowerCase===void 0?void 0:_c$slug$toLowerCase.call(_c$slug))==='kolca'||(c===null||c===void 0?void 0:(_c$slug2=c.slug)===null||_c$slug2===void 0?void 0:(_c$slug2$toLowerCase=_c$slug2.toLowerCase)===null||_c$slug2$toLowerCase===void 0?void 0:_c$slug2$toLowerCase.call(_c$slug2))==='koltsa';});return(_found$termId=found===null||found===void 0?void 0:found.termId)!==null&&_found$termId!==void 0?_found$termId:null;},[terms,categories]);const isRings=ringsCategoryId!=null&&Number(productFilters===null||productFilters===void 0?void 0:productFilters.category)===Number(ringsCategoryId);// --- Отсортированный список размеров по возрастанию\nconst sortedSizes=useMemo(()=>{const toNum=sizeObj=>{var _sizeObj$name;let str=String((_sizeObj$name=sizeObj===null||sizeObj===void 0?void 0:sizeObj.name)!==null&&_sizeObj$name!==void 0?_sizeObj$name:'').trim().replace(',','.').replace('½','.5');const m=str.match(/[\\d.]+/g);if(!m)return Number.POSITIVE_INFINITY;const num=parseFloat(m[0]);return Number.isNaN(num)?Number.POSITIVE_INFINITY:num;};return[...((terms===null||terms===void 0?void 0:terms.sizes)||[])].filter(size=>size.count>0)// Only include sizes where count > 0\n.sort((a,b)=>toNum(a)-toNum(b));},[terms===null||terms===void 0?void 0:terms.sizes]);const handleTagToggle=tag=>{let activeTagsTemporary=[];if(selectedTags.includes(tag)){activeTagsTemporary=selectedTags.filter(selectedTag=>selectedTag!==tag);}else{activeTagsTemporary=[...selectedTags,tag];}setSelectedTags(activeTagsTemporary);onTagClick(activeTagsTemporary);};function handleCategoryClick(event){event.preventDefault();const selectedCategoryId=event.target.dataset.id;onCatClick(selectedCategoryId);setOpenDropdownIndex(null);}const handleColorToggle=color=>{let activeColorsTemporary=[];if(selectedColors.includes(color)){activeColorsTemporary=selectedColors.filter(selectedColor=>selectedColor!==color);}else{activeColorsTemporary=[...selectedColors,color];}setSelectedColors(activeColorsTemporary);onColorClick(activeColorsTemporary);};const handleSizeToggle=size=>{let activeSizesTemporary=[];if(selectedSizes.includes(size)){activeSizesTemporary=selectedSizes.filter(selectedSize=>selectedSize!==size);}else{activeSizesTemporary=[...selectedSizes,size];}setSelectedSizes(activeSizesTemporary);onSizeClick(activeSizesTemporary);};const toggleDropdown=(index,event)=>{event.stopPropagation();setOpenDropdownIndex(prevIndex=>prevIndex===index?null:index);};useEffect(()=>{if(tags){// базовый список (только с товарами)\nlet next=tags.filter(tag=>tag.count!==0);// по категории\nif(productFilters.category>0){const activeCategoryTags=JSON.parse(categories.filter(item=>item.termId==productFilters.category)[0].category_tags);next=next.filter(tag=>activeCategoryTags.includes(Number(tag.termId)));}// поиск по камням\nif(stonesInputValue.length>0){const q=stonesInputValue.toLowerCase();next=next.filter(tag=>tag.name.toLowerCase().includes(q));}setFilteredTags(next);}},[tags,productFilters,stonesInputValue,categories]);// Синхронизация локальных выбранных значений со стором фильтров\nuseEffect(()=>setSelectedTags(productFilters.tags||[]),[productFilters.tags]);useEffect(()=>setSelectedColors(productFilters.colors||[]),[productFilters.colors]);useEffect(()=>setSelectedSizes(productFilters.sizes||[]),[productFilters.sizes]);useEffect(()=>{setSelectedCategoryName('');},[productFilters]);// Закрытие дропдаунов по клику вне\nuseEffect(()=>{const handleClick=event=>{const target=event.target;const parent=target.parentElement;if(!target.classList.contains('dropdown_selector')&&!(parent&&parent.classList.contains('dropdown_selector'))){setOpenDropdownIndex(null);}};document.addEventListener('click',handleClick);return()=>document.removeEventListener('click',handleClick);},[]);// Имя выбранной категории из URL\nuseEffect(()=>{const query=new URLSearchParams(location.search);const categoryId=query.get('category');if(categoryId&&terms!==null&&terms!==void 0&&terms.categories){const category=terms.categories.find(cat=>cat.termId===parseInt(categoryId));if(category)setSelectedCategoryName(category.name);}},[location.search,terms===null||terms===void 0?void 0:terms.categories]);function handleStonesInput(input){const inputValue=input.target.value;setStonesInputValue(inputValue);}const handleSortChange=value=>{setProductFilters(prevFilters=>({...prevFilters,sortBy:value,offset:0}));};const handleMasterpieceChange=event=>{setProductFilters(prevFilters=>({...prevFilters,masterpiece:event.target.checked?1:''}));};const handleIridescentChange=event=>{setProductFilters(prevFilters=>({...prevFilters,iridescent:event.target.checked?1:''}));};// Если ушли из «Кольца» — сброс размеров и закрытие дропдауна размеров (index 8)\nuseEffect(()=>{var _productFilters$sizes;if(!isRings&&(selectedSizes.length>0||(((_productFilters$sizes=productFilters.sizes)===null||_productFilters$sizes===void 0?void 0:_productFilters$sizes.length)||0)>0)){setSelectedSizes([]);setProductFilters(prev=>({...prev,sizes:[],offset:0}));if(openDropdownIndex===8)setOpenDropdownIndex(null);}},[isRings]);// eslint-disable-line react-hooks/exhaustive-deps\nconst sortOptions=[{value:'default',label:'По умолчанию'},{value:'price-asc',label:'По возрастанию цены'},{value:'price-desc',label:'По убыванию цены'},{value:'date-desc',label:'По новизне'},{value:'discount-desc',label:'По размеру скидки'}];return/*#__PURE__*/_jsxs(\"section\",{className:\"tag-section\",children:[isBigScreen&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"sorting-area\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"sorting-dropdown\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"sorting__button pointer\",onClick:event=>toggleDropdown(0,event),children:/*#__PURE__*/_jsx(\"img\",{src:sorting,alt:\"sort\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"sorting-content overflow-hidden \".concat(openDropdownIndex===0?'sorting-content_visible':''),children:/*#__PURE__*/_jsx(\"div\",{className:\"tags__dropdown sorting_by\",children:sortOptions.map(option=>/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleSortChange(option.value),style:{fontWeight:productFilters.sortBy===option.value?'bold':'normal'},children:option.label},option.value))})})]}),isRings&&/*#__PURE__*/_jsxs(\"div\",{className:\"sorting-dropdown\",children:[/*#__PURE__*/_jsxs(\"button\",{type:\"button\",className:\"sorting-dropdown__button pointer\",onClick:event=>toggleDropdown(8,event),children:[selectedSizes.length>0?\"\\u0420\\u0430\\u0437\\u043C\\u0435\\u0440\\u044B (\".concat(selectedSizes.length,\") \"):'Размеры',/*#__PURE__*/_jsx(\"img\",{src:caret,alt:\"caret\",style:{marginLeft:'5px'}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"sorting-content dropdown_selector \".concat(openDropdownIndex===8?'sorting-content_visible':''),children:[/*#__PURE__*/_jsx(\"div\",{className:\"tags__dropdown dropdown_selector\",children:sortedSizes.map(size=>/*#__PURE__*/_jsxs(\"label\",{className:\"tag-label\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",value:size.termId,className:\"tag-button_dropdown\",checked:(selectedSizes===null||selectedSizes===void 0?void 0:selectedSizes.some(s=>s===size.termId))||false,onChange:event=>{event.stopPropagation();handleSizeToggle(size.termId);}}),/*#__PURE__*/_jsx(\"div\",{className:\"tag-pseudo-checkbox pointer\",onClick:event=>event.stopPropagation(),children:size.name})]},size.termId))}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"sorting-button\",onClick:()=>setOpenDropdownIndex(null),children:\"\\u0413\\u043E\\u0442\\u043E\\u0432\\u043E\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"sorting-dropdown\",children:[/*#__PURE__*/_jsxs(\"button\",{type:\"button\",className:\"sorting-dropdown__button pointer\",onClick:event=>toggleDropdown(5,event),children:[\"\\u0412\\u0441\\u0435 \\u043A\\u0430\\u043C\\u043D\\u0438 \",/*#__PURE__*/_jsx(\"img\",{src:caret,alt:\"caret\",style:{marginLeft:'5px'}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"sorting-content dropdown_selector \".concat(openDropdownIndex===5?'sorting-content_visible':''),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"tags__dropdown dropdown_selector\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"dropdown_selector\",children:/*#__PURE__*/_jsx(\"input\",{className:\"stone-search\",type:\"text\",onChange:handleStonesInput,placeholder:\"\\u043D\\u0430\\u0447\\u043D\\u0438\\u0442\\u0435 \\u0432\\u0432\\u043E\\u0434\\u0438\\u0442\\u044C \\u043D\\u0430\\u0437\\u0432\\u0430\\u043D\\u0438\\u0435\"})}),tags&&filteredTags.map(tag=>/*#__PURE__*/_jsxs(\"label\",{className:\"tag-label\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",value:tag.termId,className:\"tag-button_dropdown\",checked:(selectedTags===null||selectedTags===void 0?void 0:selectedTags.some(t=>t===tag.termId))||false,onChange:event=>{event.stopPropagation();handleTagToggle(tag.termId);}}),/*#__PURE__*/_jsxs(\"div\",{className:\"tag-pseudo-checkbox pointer\",onClick:event=>event.stopPropagation(),children:[tag.name,!productFilters.category&&/*#__PURE__*/_jsx(\"span\",{className:\"tag-count\",children:tag.count})]})]},tag.termId))]}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"sorting-button\",onClick:()=>setOpenDropdownIndex(null),children:\"\\u0413\\u043E\\u0442\\u043E\\u0432\\u043E\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"sorting-dropdown\",children:[/*#__PURE__*/_jsxs(\"button\",{type:\"button\",className:\"sorting-dropdown__button pointer\",onClick:event=>toggleDropdown(9,event),children:[selectedColors.length>0?\"\\u0426\\u0432\\u0435\\u0442\\u0430 (\".concat(selectedColors.length,\") \"):'Цвета',/*#__PURE__*/_jsx(\"img\",{src:caret,alt:\"caret\",style:{marginLeft:'5px'}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"sorting-content dropdown_selector \".concat(openDropdownIndex===9?'sorting-content_visible':''),children:[/*#__PURE__*/_jsx(\"div\",{className:\"tags__dropdown dropdown_selector\",children:terms===null||terms===void 0?void 0:(_terms$colors=terms.colors)===null||_terms$colors===void 0?void 0:_terms$colors.map(color=>/*#__PURE__*/_jsxs(\"label\",{className:\"tag-label\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",value:color.termId,className:\"tag-button_dropdown\",checked:(selectedColors===null||selectedColors===void 0?void 0:selectedColors.some(c=>c===color.termId))||false,onChange:event=>{event.stopPropagation();handleColorToggle(color.termId);}}),/*#__PURE__*/_jsxs(\"div\",{className:\"tag-pseudo-checkbox pointer\",onClick:event=>event.stopPropagation(),children:[color.name,/*#__PURE__*/_jsx(\"span\",{className:\"color_ball\",style:{background:color.extra}})]})]},color.termId))}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"sorting-button\",onClick:()=>setOpenDropdownIndex(null),children:\"\\u0413\\u043E\\u0442\\u043E\\u0432\\u043E\"})]})]}),/*#__PURE__*/_jsxs(\"label\",{className:\"tag-label\",children:[/*#__PURE__*/_jsx(\"input\",{className:\"tag-button\",type:\"checkbox\",checked:!!productFilters.masterpiece,onChange:handleMasterpieceChange}),/*#__PURE__*/_jsx(\"div\",{className:\"sorting-dropdown__button pointer\",children:\"\\u0410\\u0432\\u0442\\u043E\\u0440\\u0441\\u043A\\u0438\\u0435 \\u0443\\u043A\\u0440\\u0430\\u0448\\u0435\\u043D\\u0438\\u044F\"})]}),/*#__PURE__*/_jsxs(\"label\",{className:\"tag-label\",children:[/*#__PURE__*/_jsx(\"input\",{className:\"tag-button\",type:\"checkbox\",checked:!!productFilters.iridescent,onChange:handleIridescentChange}),/*#__PURE__*/_jsx(\"div\",{className:\"sorting-dropdown__button pointer\",children:\"\\u041E\\u043F\\u0442\\u0438\\u0447\\u0435\\u0441\\u043A\\u0438\\u0439 \\u044D\\u0444\\u0444\\u0435\\u043A\\u0442\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"tag-area\",children:tags&&filteredTags.slice(0,15).map(tag=>/*#__PURE__*/_jsxs(\"label\",{className:\"tag-label\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",value:tag.termId,className:\"tag-button\",checked:(selectedTags===null||selectedTags===void 0?void 0:selectedTags.some(t=>t===tag.termId))||false,onChange:()=>handleTagToggle(tag.termId)}),/*#__PURE__*/_jsxs(\"div\",{className:\"tag-pseudo-button pointer\",children:[tag.name,!productFilters.category&&/*#__PURE__*/_jsx(\"span\",{className:\"tag-count\",children:tag.count})]})]},tag.termId))})]}),isSmallScreen&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"sorting-area\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"tags_flex\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"sorting-dropdown\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"sorting__button pointer\",onClick:event=>toggleDropdown(0,event),children:/*#__PURE__*/_jsx(\"img\",{src:sorting,alt:\"sort\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"sorting-content overflow-hidden \".concat(openDropdownIndex===0?'sorting-content_visible':''),children:/*#__PURE__*/_jsx(\"div\",{className:\"tags__dropdown sorting_by\",children:sortOptions.map(option=>/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleSortChange(option.value),style:{fontWeight:productFilters.sortBy===option.value?'bold':'normal'},children:option.label},option.value))})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"sorting-dropdown\",children:[/*#__PURE__*/_jsxs(\"button\",{type:\"button\",className:\"sorting-dropdown__button pointer\",onClick:event=>toggleDropdown(12,event),children:[\"\\u041A\\u0430\\u0442\\u0435\\u0433\\u043E\\u0440\\u0438\\u0438 \",/*#__PURE__*/_jsx(\"img\",{src:caret,alt:\"caret\",style:{marginLeft:'5px'}})]}),/*#__PURE__*/_jsx(\"div\",{className:\"sorting-content dropdown_selector \".concat(openDropdownIndex===12?'sorting-content_visible':''),children:/*#__PURE__*/_jsx(\"div\",{className:\"tags__dropdown dropdown_selector\",children:categories&&categories.map(category=>/*#__PURE__*/_jsx(NavLink,{to:\"\",className:\"tag-pseudo-checkbox\",onClick:handleCategoryClick,\"data-id\":category.termId,style:{marginBottom:'5px'},children:category.name},category.termId))})})]}),isRings&&/*#__PURE__*/_jsxs(\"div\",{className:\"sorting-dropdown\",children:[/*#__PURE__*/_jsxs(\"button\",{type:\"button\",className:\"sorting-dropdown__button pointer\",onClick:event=>toggleDropdown(8,event),children:[selectedSizes.length>0?\"\\u0420\\u0430\\u0437\\u043C\\u0435\\u0440\\u044B (\".concat(selectedSizes.length,\") \"):'Размеры  (${selectedSizes.length}) ',/*#__PURE__*/_jsx(\"img\",{src:caret,alt:\"caret\",style:{marginLeft:'5px'}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"sorting-content dropdown_selector \".concat(openDropdownIndex===8?'sorting-content_visible':''),children:[/*#__PURE__*/_jsx(\"div\",{className:\"tags__dropdown dropdown_selector\",children:sortedSizes.map(size=>/*#__PURE__*/_jsxs(\"label\",{className:\"tag-label\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",value:size.termId,className:\"tag-button_dropdown\",checked:(selectedSizes===null||selectedSizes===void 0?void 0:selectedSizes.some(s=>s===size.termId))||false,onChange:event=>{event.stopPropagation();handleSizeToggle(size.termId);}}),/*#__PURE__*/_jsx(\"div\",{className:\"tag-pseudo-checkbox pointer\",onClick:event=>event.stopPropagation(),children:size.name})]},size.termId))}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"sorting-button\",onClick:()=>setOpenDropdownIndex(null),children:\"\\u0413\\u043E\\u0442\\u043E\\u0432\\u043E\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"tags_flex\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"tag-label\",children:[/*#__PURE__*/_jsx(\"input\",{className:\"tag-button\",type:\"checkbox\",checked:!!productFilters.masterpiece,onChange:handleMasterpieceChange}),/*#__PURE__*/_jsx(\"div\",{className:\"sorting-dropdown__button pointer\",children:\"\\u0410\\u0432\\u0442\\u043E\\u0440\\u0441\\u043A\\u043E\\u0435 \\u0443\\u043A\\u0440\\u0430\\u0448\\u0435\\u043D\\u0438\\u0435\"})]}),/*#__PURE__*/_jsxs(\"label\",{className:\"tag-label\",children:[/*#__PURE__*/_jsx(\"input\",{className:\"tag-button\",type:\"checkbox\",checked:!!productFilters.iridescent,onChange:handleIridescentChange}),/*#__PURE__*/_jsx(\"div\",{className:\"sorting-dropdown__button pointer\",children:\"\\u041E\\u043F\\u0442\\u0438\\u0447\\u0435\\u0441\\u043A\\u0438\\u0439 \\u044D\\u0444\\u0444\\u0435\\u043A\\u0442\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"tag-area_mobile\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"sorting-dropdown\",children:[/*#__PURE__*/_jsxs(\"button\",{type:\"button\",className:\"tag-pseudo-button pointer\",onClick:event=>toggleDropdown(9,event),children:[selectedColors.length>0?\"\\u0426\\u0432\\u0435\\u0442 (\".concat(selectedColors.length,\") \"):'Цвет',/*#__PURE__*/_jsx(\"img\",{src:caret,alt:\"caret\",style:{marginLeft:'5px'}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"sorting-content dropdown_selector \".concat(openDropdownIndex===9?'sorting-content_visible':''),children:[/*#__PURE__*/_jsx(\"div\",{className:\"tags__dropdown dropdown_selector\",children:terms===null||terms===void 0?void 0:(_terms$colors2=terms.colors)===null||_terms$colors2===void 0?void 0:_terms$colors2.map(color=>/*#__PURE__*/_jsxs(\"label\",{className:\"tag-label\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",value:color.termId,className:\"tag-button_dropdown\",checked:(selectedColors===null||selectedColors===void 0?void 0:selectedColors.some(c=>c===color.termId))||false,onChange:event=>{event.stopPropagation();handleColorToggle(color.termId);}}),/*#__PURE__*/_jsxs(\"div\",{className:\"tag-pseudo-checkbox pointer\",onClick:event=>event.stopPropagation(),children:[color.name,/*#__PURE__*/_jsx(\"span\",{className:\"color_ball\",style:{background:color.extra}})]})]},color.termId))}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"sorting-button\",onClick:()=>setOpenDropdownIndex(null),children:\"\\u0413\\u043E\\u0442\\u043E\\u0432\\u043E\"})]})]}),tags&&filteredTags.map(tag=>/*#__PURE__*/_jsxs(\"label\",{className:\"tag-label\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",value:tag.termId,className:\"tag-button\",checked:(selectedTags===null||selectedTags===void 0?void 0:selectedTags.some(t=>t===tag.termId))||false,onChange:()=>handleTagToggle(tag.termId)}),/*#__PURE__*/_jsxs(\"div\",{className:\"tag-pseudo-button pointer\",children:[tag.name,!productFilters.category&&/*#__PURE__*/_jsx(\"span\",{className:\"tag-count\",children:tag.count})]})]},tag.termId))]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"chosen-area\",children:selectedCategoryName&&/*#__PURE__*/_jsxs(\"h1\",{className:\"category-header\",children:[\"\\u2022 \",selectedCategoryName.toUpperCase(),\" \\u2022\"]})})]});}","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}